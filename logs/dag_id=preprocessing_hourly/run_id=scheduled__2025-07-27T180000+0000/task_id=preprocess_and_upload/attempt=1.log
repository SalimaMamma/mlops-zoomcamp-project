[2025-07-27T19:07:26.571+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T19:07:26.639+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:07:26.654+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:07:26.655+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T19:07:26.683+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 18:00:00+00:00
[2025-07-27T19:07:26.705+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=2394) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T19:07:26.703+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T18:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpdf6of4ak']
[2025-07-27T19:07:26.707+0000] {standard_task_runner.py:63} INFO - Started process 2457 to run task
[2025-07-27T19:07:26.707+0000] {standard_task_runner.py:91} INFO - Job 9: Subtask preprocess_and_upload
[2025-07-27T19:07:26.729+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T19:07:26.785+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [running]> on host ad22cb2f7f4c
[2025-07-27T19:07:26.955+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T18:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T18:00:00+00:00'
[2025-07-27T19:07:26.958+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T19:07:27.030+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T19:07:27.030+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T19:07:27.369+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 19:07:27.050698 to 2025-06-28 20:07:27.050698
[2025-07-27T19:07:27.836+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 20:07:27.050698 to 2025-06-29 21:07:27.050698
[2025-07-27T19:07:28.043+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 21:07:27.050698 to 2025-06-30 22:07:27.050698
[2025-07-27T19:07:28.241+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 22:07:27.050698 to 2025-07-01 23:07:27.050698
[2025-07-27T19:07:28.513+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 23:07:27.050698 to 2025-07-03 00:07:27.050698
[2025-07-27T19:07:28.810+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 00:07:27.050698 to 2025-07-04 01:07:27.050698
[2025-07-27T19:07:29.087+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 01:07:27.050698 to 2025-07-05 02:07:27.050698
[2025-07-27T19:07:29.571+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 02:07:27.050698 to 2025-07-06 03:07:27.050698
[2025-07-27T19:07:30.270+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 03:07:27.050698 to 2025-07-07 04:07:27.050698
[2025-07-27T19:07:30.644+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 04:07:27.050698 to 2025-07-08 05:07:27.050698
[2025-07-27T19:07:30.988+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 05:07:27.050698 to 2025-07-09 06:07:27.050698
[2025-07-27T19:07:31.166+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 06:07:27.050698 to 2025-07-10 07:07:27.050698
[2025-07-27T19:07:31.375+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 07:07:27.050698 to 2025-07-11 08:07:27.050698
[2025-07-27T19:07:31.591+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 08:07:27.050698 to 2025-07-12 09:07:27.050698
[2025-07-27T19:07:32.081+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 09:07:27.050698 to 2025-07-13 10:07:27.050698
[2025-07-27T19:07:32.277+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 10:07:27.050698 to 2025-07-14 11:07:27.050698
[2025-07-27T19:07:32.498+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 11:07:27.050698 to 2025-07-15 12:07:27.050698
[2025-07-27T19:07:32.978+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 12:07:27.050698 to 2025-07-16 13:07:27.050698
[2025-07-27T19:07:34.979+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 13:07:27.050698 to 2025-07-17 14:07:27.050698
[2025-07-27T19:07:35.306+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 14:07:27.050698 to 2025-07-18 15:07:27.050698
[2025-07-27T19:07:35.519+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 15:07:27.050698 to 2025-07-19 16:07:27.050698
[2025-07-27T19:07:35.704+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 16:07:27.050698 to 2025-07-20 17:07:27.050698
[2025-07-27T19:07:36.256+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 17:07:27.050698 to 2025-07-21 18:07:27.050698
[2025-07-27T19:07:36.876+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 18:07:27.050698 to 2025-07-22 19:07:27.050698
[2025-07-27T19:07:37.058+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 19:07:27.050698 to 2025-07-23 20:07:27.050698
[2025-07-27T19:07:37.249+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 20:07:27.050698 to 2025-07-24 21:07:27.050698
[2025-07-27T19:07:37.470+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 21:07:27.050698 to 2025-07-25 22:07:27.050698
[2025-07-27T19:07:37.661+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 22:07:27.050698 to 2025-07-26 23:07:27.050698
[2025-07-27T19:07:40.549+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 23:07:27.050698 to 2025-07-27 19:07:27.050698
[2025-07-27T19:07:40.862+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727190740.csv
[2025-07-27T19:07:41.359+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 19:07:27.050698 to 2025-06-28 20:07:27.050698
[2025-07-27T19:07:41.987+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 20:07:27.050698 to 2025-06-29 21:07:27.050698
[2025-07-27T19:07:42.652+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 21:07:27.050698 to 2025-06-30 22:07:27.050698
[2025-07-27T19:07:42.869+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 22:07:27.050698 to 2025-07-01 23:07:27.050698
[2025-07-27T19:07:43.084+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 23:07:27.050698 to 2025-07-03 00:07:27.050698
[2025-07-27T19:07:43.307+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 00:07:27.050698 to 2025-07-04 01:07:27.050698
[2025-07-27T19:07:43.546+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 01:07:27.050698 to 2025-07-05 02:07:27.050698
[2025-07-27T19:07:43.791+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 02:07:27.050698 to 2025-07-06 03:07:27.050698
[2025-07-27T19:07:44.075+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 03:07:27.050698 to 2025-07-07 04:07:27.050698
[2025-07-27T19:07:44.287+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 04:07:27.050698 to 2025-07-08 05:07:27.050698
[2025-07-27T19:07:44.546+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 05:07:27.050698 to 2025-07-09 06:07:27.050698
[2025-07-27T19:07:45.804+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 06:07:27.050698 to 2025-07-10 07:07:27.050698
[2025-07-27T19:07:46.020+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 07:07:27.050698 to 2025-07-11 08:07:27.050698
[2025-07-27T19:07:47.310+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 08:07:27.050698 to 2025-07-12 09:07:27.050698
[2025-07-27T19:07:47.857+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 09:07:27.050698 to 2025-07-13 10:07:27.050698
[2025-07-27T19:07:48.103+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 10:07:27.050698 to 2025-07-14 11:07:27.050698
[2025-07-27T19:07:49.078+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 11:07:27.050698 to 2025-07-15 12:07:27.050698
[2025-07-27T19:07:49.934+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 12:07:27.050698 to 2025-07-16 13:07:27.050698
[2025-07-27T19:07:50.522+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 13:07:27.050698 to 2025-07-17 14:07:27.050698
[2025-07-27T19:07:50.734+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 14:07:27.050698 to 2025-07-18 15:07:27.050698
[2025-07-27T19:07:49.476+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 15:07:27.050698 to 2025-07-19 16:07:27.050698
[2025-07-27T19:07:49.738+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 16:07:27.050698 to 2025-07-20 17:07:27.050698
[2025-07-27T19:07:49.985+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 17:07:27.050698 to 2025-07-21 18:07:27.050698
[2025-07-27T19:07:50.165+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 18:07:27.050698 to 2025-07-22 19:07:27.050698
[2025-07-27T19:07:50.389+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 19:07:27.050698 to 2025-07-23 20:07:27.050698
[2025-07-27T19:07:50.612+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 20:07:27.050698 to 2025-07-24 21:07:27.050698
[2025-07-27T19:07:51.199+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 21:07:27.050698 to 2025-07-25 22:07:27.050698
[2025-07-27T19:07:51.416+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 22:07:27.050698 to 2025-07-26 23:07:27.050698
[2025-07-27T19:07:51.616+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 23:07:27.050698 to 2025-07-27 19:07:27.050698
[2025-07-27T19:07:51.799+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727190751.csv
[2025-07-27T19:07:51.800+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T19:07:51.802+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T19:07:51.884+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727183245.csv
[2025-07-27T19:07:51.968+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727183428.csv
[2025-07-27T19:07:52.029+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727183456.csv
[2025-07-27T19:07:52.069+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727190740.csv
[2025-07-27T19:07:52.083+0000] {data_processing.py:84} INFO - Combined 8647 records for BTC-USD
[2025-07-27T19:07:52.085+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8647, 7)
[2025-07-27T19:07:52.087+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T19:07:52.286+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8597, 84)
[2025-07-27T19:07:52.286+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8597, 84)
[2025-07-27T19:07:52.287+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T19:07:52.308+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T19:07:52.309+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T19:07:52.315+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T19:07:52.316+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8597, 80)
[2025-07-27T19:07:52.336+0000] {ingestion_inference.py:96} INFO - Shape des données après scaling : (8597, 80)
[2025-07-27T19:07:52.338+0000] {ingestion_inference.py:104} INFO - Extraction dernière ligne timestamp 8596 pour export : shape=(1, 80)
[2025-07-27T19:07:52.403+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T19:07:52.428+0000] {ingestion_inference.py:118} INFO - Uploaded features to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=18/features.parquet
[2025-07-27T19:07:52.429+0000] {ingestion_inference.py:120} INFO - === Fin du préprocessing ===
[2025-07-27T19:07:52.434+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T19:07:52.436+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T19:07:52.453+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T180000, start_date=20250727T190726, end_date=20250727T190752
[2025-07-27T19:07:52.543+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T19:07:52.574+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T19:07:52.578+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T19:21:32.120+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T19:21:32.160+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:21:32.172+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:21:32.173+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T19:21:32.428+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 18:00:00+00:00
[2025-07-27T19:21:32.447+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=579) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T19:21:32.447+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T18:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmp054t5q0b']
[2025-07-27T19:21:32.449+0000] {standard_task_runner.py:63} INFO - Started process 596 to run task
[2025-07-27T19:21:32.449+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T19:21:32.466+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T19:21:32.508+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [running]> on host d1e83e43e29f
[2025-07-27T19:21:32.572+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T19:21:32.642+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T18:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T18:00:00+00:00'
[2025-07-27T19:21:32.644+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T19:21:32.672+0000] {ingestion_inference.py:55} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T19:21:32.673+0000] {ingestion_inference.py:64} INFO - === Début du préprocessing ===
[2025-07-27T19:21:32.911+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 19:21:32.682262 to 2025-06-28 20:21:32.682262
[2025-07-27T19:21:35.893+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 20:21:32.682262 to 2025-06-29 21:21:32.682262
[2025-07-27T19:21:36.413+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 21:21:32.682262 to 2025-06-30 22:21:32.682262
[2025-07-27T19:21:38.087+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 22:21:32.682262 to 2025-07-01 23:21:32.682262
[2025-07-27T19:21:38.335+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 23:21:32.682262 to 2025-07-03 00:21:32.682262
[2025-07-27T19:21:38.577+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 00:21:32.682262 to 2025-07-04 01:21:32.682262
[2025-07-27T19:21:38.794+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 01:21:32.682262 to 2025-07-05 02:21:32.682262
[2025-07-27T19:21:38.986+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 02:21:32.682262 to 2025-07-06 03:21:32.682262
[2025-07-27T19:21:39.482+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 03:21:32.682262 to 2025-07-07 04:21:32.682262
[2025-07-27T19:21:39.727+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 04:21:32.682262 to 2025-07-08 05:21:32.682262
[2025-07-27T19:21:39.951+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 05:21:32.682262 to 2025-07-09 06:21:32.682262
[2025-07-27T19:21:40.649+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 06:21:32.682262 to 2025-07-10 07:21:32.682262
[2025-07-27T19:21:41.078+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 07:21:32.682262 to 2025-07-11 08:21:32.682262
[2025-07-27T19:21:41.289+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 08:21:32.682262 to 2025-07-12 09:21:32.682262
[2025-07-27T19:21:41.491+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 09:21:32.682262 to 2025-07-13 10:21:32.682262
[2025-07-27T19:21:41.738+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 10:21:32.682262 to 2025-07-14 11:21:32.682262
[2025-07-27T19:21:42.311+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 11:21:32.682262 to 2025-07-15 12:21:32.682262
[2025-07-27T19:21:45.227+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 12:21:32.682262 to 2025-07-16 13:21:32.682262
[2025-07-27T19:21:45.417+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 13:21:32.682262 to 2025-07-17 14:21:32.682262
[2025-07-27T19:21:45.613+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 14:21:32.682262 to 2025-07-18 15:21:32.682262
[2025-07-27T19:21:45.798+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 15:21:32.682262 to 2025-07-19 16:21:32.682262
[2025-07-27T19:21:46.032+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 16:21:32.682262 to 2025-07-20 17:21:32.682262
[2025-07-27T19:21:46.277+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 17:21:32.682262 to 2025-07-21 18:21:32.682262
[2025-07-27T19:21:46.476+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 18:21:32.682262 to 2025-07-22 19:21:32.682262
[2025-07-27T19:21:47.957+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 19:21:32.682262 to 2025-07-23 20:21:32.682262
[2025-07-27T19:21:48.163+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 20:21:32.682262 to 2025-07-24 21:21:32.682262
[2025-07-27T19:21:49.303+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 21:21:32.682262 to 2025-07-25 22:21:32.682262
[2025-07-27T19:21:49.507+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 22:21:32.682262 to 2025-07-26 23:21:32.682262
[2025-07-27T19:21:49.727+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 23:21:32.682262 to 2025-07-27 19:21:32.682262
[2025-07-27T19:21:49.886+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727192149.csv
[2025-07-27T19:21:50.504+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 19:21:32.682262 to 2025-06-28 20:21:32.682262
[2025-07-27T19:21:51.054+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 20:21:32.682262 to 2025-06-29 21:21:32.682262
[2025-07-27T19:21:51.260+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 21:21:32.682262 to 2025-06-30 22:21:32.682262
[2025-07-27T19:21:51.460+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 22:21:32.682262 to 2025-07-01 23:21:32.682262
[2025-07-27T19:21:51.744+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 23:21:32.682262 to 2025-07-03 00:21:32.682262
[2025-07-27T19:21:51.952+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 00:21:32.682262 to 2025-07-04 01:21:32.682262
[2025-07-27T19:21:52.138+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 01:21:32.682262 to 2025-07-05 02:21:32.682262
[2025-07-27T19:21:52.346+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 02:21:32.682262 to 2025-07-06 03:21:32.682262
[2025-07-27T19:21:52.592+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 03:21:32.682262 to 2025-07-07 04:21:32.682262
[2025-07-27T19:21:52.787+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 04:21:32.682262 to 2025-07-08 05:21:32.682262
[2025-07-27T19:21:52.990+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 05:21:32.682262 to 2025-07-09 06:21:32.682262
[2025-07-27T19:21:53.418+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 06:21:32.682262 to 2025-07-10 07:21:32.682262
[2025-07-27T19:21:55.420+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 07:21:32.682262 to 2025-07-11 08:21:32.682262
[2025-07-27T19:21:55.601+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 08:21:32.682262 to 2025-07-12 09:21:32.682262
[2025-07-27T19:21:55.816+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 09:21:32.682262 to 2025-07-13 10:21:32.682262
[2025-07-27T19:21:56.271+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 10:21:32.682262 to 2025-07-14 11:21:32.682262
[2025-07-27T19:21:56.496+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 11:21:32.682262 to 2025-07-15 12:21:32.682262
[2025-07-27T19:21:56.914+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 12:21:32.682262 to 2025-07-16 13:21:32.682262
[2025-07-27T19:21:57.117+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 13:21:32.682262 to 2025-07-17 14:21:32.682262
[2025-07-27T19:21:57.321+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 14:21:32.682262 to 2025-07-18 15:21:32.682262
[2025-07-27T19:21:57.513+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 15:21:32.682262 to 2025-07-19 16:21:32.682262
[2025-07-27T19:21:57.685+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 16:21:32.682262 to 2025-07-20 17:21:32.682262
[2025-07-27T19:21:57.867+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 17:21:32.682262 to 2025-07-21 18:21:32.682262
[2025-07-27T19:21:58.369+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 18:21:32.682262 to 2025-07-22 19:21:32.682262
[2025-07-27T19:21:58.591+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 19:21:32.682262 to 2025-07-23 20:21:32.682262
[2025-07-27T19:21:58.799+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 20:21:32.682262 to 2025-07-24 21:21:32.682262
[2025-07-27T19:21:59.000+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 21:21:32.682262 to 2025-07-25 22:21:32.682262
[2025-07-27T19:21:59.173+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 22:21:32.682262 to 2025-07-26 23:21:32.682262
[2025-07-27T19:21:59.380+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 23:21:32.682262 to 2025-07-27 19:21:32.682262
[2025-07-27T19:21:59.464+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727192159.csv
[2025-07-27T19:21:59.465+0000] {ingestion_inference.py:69} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T19:21:59.505+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727192013.csv
[2025-07-27T19:21:59.530+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727192149.csv
[2025-07-27T19:21:59.537+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T19:21:59.645+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T19:21:59.646+0000] {ingestion_inference.py:75} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T19:21:59.671+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-27T19:21:59.679+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-27T19:21:59.680+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-27T19:21:59.800+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T19:21:59.801+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 103, in preprocess_and_upload
    date_str = execution_date.strftime("%Y-%m-%d")
               ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
[2025-07-27T19:21:59.823+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T180000, start_date=20250727T192132, end_date=20250727T192159
[2025-07-27T19:21:59.841+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload ('str' object has no attribute 'strftime'; 596)
[2025-07-27T19:21:59.894+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T19:21:59.915+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T19:21:59.951+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T19:30:18.454+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T19:30:18.501+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:30:18.513+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:30:18.514+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T19:30:18.568+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 18:00:00+00:00
[2025-07-27T19:30:18.593+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=766) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T19:30:18.591+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T18:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpaair1eat']
[2025-07-27T19:30:18.595+0000] {standard_task_runner.py:63} INFO - Started process 783 to run task
[2025-07-27T19:30:18.595+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T19:30:18.617+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T19:30:18.672+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [running]> on host d1e83e43e29f
[2025-07-27T19:30:18.781+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T19:30:18.861+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T18:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T18:00:00+00:00'
[2025-07-27T19:30:18.862+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T19:30:18.906+0000] {ingestion_inference.py:55} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T19:30:18.907+0000] {ingestion_inference.py:64} INFO - === Début du préprocessing ===
[2025-07-27T19:30:19.890+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 19:30:18.921142 to 2025-06-28 20:30:18.921142
[2025-07-27T19:30:20.392+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 20:30:18.921142 to 2025-06-29 21:30:18.921142
[2025-07-27T19:30:20.576+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 21:30:18.921142 to 2025-06-30 22:30:18.921142
[2025-07-27T19:30:20.754+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 22:30:18.921142 to 2025-07-01 23:30:18.921142
[2025-07-27T19:30:20.969+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 23:30:18.921142 to 2025-07-03 00:30:18.921142
[2025-07-27T19:30:21.147+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 00:30:18.921142 to 2025-07-04 01:30:18.921142
[2025-07-27T19:30:24.746+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 01:30:18.921142 to 2025-07-05 02:30:18.921142
[2025-07-27T19:30:24.924+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 02:30:18.921142 to 2025-07-06 03:30:18.921142
[2025-07-27T19:30:25.174+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 03:30:18.921142 to 2025-07-07 04:30:18.921142
[2025-07-27T19:30:25.373+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 04:30:18.921142 to 2025-07-08 05:30:18.921142
[2025-07-27T19:30:25.870+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 05:30:18.921142 to 2025-07-09 06:30:18.921142
[2025-07-27T19:30:26.353+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 06:30:18.921142 to 2025-07-10 07:30:18.921142
[2025-07-27T19:30:26.560+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 07:30:18.921142 to 2025-07-11 08:30:18.921142
[2025-07-27T19:30:27.970+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 08:30:18.921142 to 2025-07-12 09:30:18.921142
[2025-07-27T19:30:28.181+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 09:30:18.921142 to 2025-07-13 10:30:18.921142
[2025-07-27T19:30:29.064+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 10:30:18.921142 to 2025-07-14 11:30:18.921142
[2025-07-27T19:30:29.541+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 11:30:18.921142 to 2025-07-15 12:30:18.921142
[2025-07-27T19:30:29.770+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 12:30:18.921142 to 2025-07-16 13:30:18.921142
[2025-07-27T19:30:29.979+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 13:30:18.921142 to 2025-07-17 14:30:18.921142
[2025-07-27T19:30:30.443+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 14:30:18.921142 to 2025-07-18 15:30:18.921142
[2025-07-27T19:30:30.659+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 15:30:18.921142 to 2025-07-19 16:30:18.921142
[2025-07-27T19:30:30.883+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 16:30:18.921142 to 2025-07-20 17:30:18.921142
[2025-07-27T19:30:31.111+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 17:30:18.921142 to 2025-07-21 18:30:18.921142
[2025-07-27T19:30:31.389+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 18:30:18.921142 to 2025-07-22 19:30:18.921142
[2025-07-27T19:30:31.690+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 19:30:18.921142 to 2025-07-23 20:30:18.921142
[2025-07-27T19:30:32.196+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 20:30:18.921142 to 2025-07-24 21:30:18.921142
[2025-07-27T19:30:32.617+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 21:30:18.921142 to 2025-07-25 22:30:18.921142
[2025-07-27T19:30:32.837+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 22:30:18.921142 to 2025-07-26 23:30:18.921142
[2025-07-27T19:30:34.085+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 23:30:18.921142 to 2025-07-27 19:30:18.921142
[2025-07-27T19:30:34.250+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727193034.csv
[2025-07-27T19:30:34.517+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 19:30:18.921142 to 2025-06-28 20:30:18.921142
[2025-07-27T19:30:34.730+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 20:30:18.921142 to 2025-06-29 21:30:18.921142
[2025-07-27T19:30:35.088+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 21:30:18.921142 to 2025-06-30 22:30:18.921142
[2025-07-27T19:30:35.937+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 22:30:18.921142 to 2025-07-01 23:30:18.921142
[2025-07-27T19:30:36.149+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 23:30:18.921142 to 2025-07-03 00:30:18.921142
[2025-07-27T19:30:37.139+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 00:30:18.921142 to 2025-07-04 01:30:18.921142
[2025-07-27T19:30:38.395+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 01:30:18.921142 to 2025-07-05 02:30:18.921142
[2025-07-27T19:30:38.880+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 02:30:18.921142 to 2025-07-06 03:30:18.921142
[2025-07-27T19:30:39.083+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 03:30:18.921142 to 2025-07-07 04:30:18.921142
[2025-07-27T19:30:39.595+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 04:30:18.921142 to 2025-07-08 05:30:18.921142
[2025-07-27T19:30:40.017+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 05:30:18.921142 to 2025-07-09 06:30:18.921142
[2025-07-27T19:30:40.509+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 06:30:18.921142 to 2025-07-10 07:30:18.921142
[2025-07-27T19:30:41.052+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 07:30:18.921142 to 2025-07-11 08:30:18.921142
[2025-07-27T19:30:41.332+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 08:30:18.921142 to 2025-07-12 09:30:18.921142
[2025-07-27T19:30:41.523+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 09:30:18.921142 to 2025-07-13 10:30:18.921142
[2025-07-27T19:30:41.705+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 10:30:18.921142 to 2025-07-14 11:30:18.921142
[2025-07-27T19:30:41.972+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 11:30:18.921142 to 2025-07-15 12:30:18.921142
[2025-07-27T19:30:43.917+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 12:30:18.921142 to 2025-07-16 13:30:18.921142
[2025-07-27T19:30:44.191+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 13:30:18.921142 to 2025-07-17 14:30:18.921142
[2025-07-27T19:30:44.441+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 14:30:18.921142 to 2025-07-18 15:30:18.921142
[2025-07-27T19:30:46.140+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 15:30:18.921142 to 2025-07-19 16:30:18.921142
[2025-07-27T19:30:46.343+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 16:30:18.921142 to 2025-07-20 17:30:18.921142
[2025-07-27T19:30:46.541+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 17:30:18.921142 to 2025-07-21 18:30:18.921142
[2025-07-27T19:30:46.752+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 18:30:18.921142 to 2025-07-22 19:30:18.921142
[2025-07-27T19:30:46.951+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 19:30:18.921142 to 2025-07-23 20:30:18.921142
[2025-07-27T19:30:47.134+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 20:30:18.921142 to 2025-07-24 21:30:18.921142
[2025-07-27T19:30:47.348+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 21:30:18.921142 to 2025-07-25 22:30:18.921142
[2025-07-27T19:30:47.581+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 22:30:18.921142 to 2025-07-26 23:30:18.921142
[2025-07-27T19:30:47.751+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 23:30:18.921142 to 2025-07-27 19:30:18.921142
[2025-07-27T19:30:47.901+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727193047.csv
[2025-07-27T19:30:47.903+0000] {ingestion_inference.py:69} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T19:30:47.986+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727192648.csv
[2025-07-27T19:30:48.044+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727193034.csv
[2025-07-27T19:30:48.053+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T19:30:48.255+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T19:30:48.256+0000] {ingestion_inference.py:75} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T19:30:48.290+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-27T19:30:48.307+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-27T19:30:48.309+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-27T19:30:48.425+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T19:30:48.427+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 103, in preprocess_and_upload
    date_str = execution_date.strftime("%Y-%m-%d")
               ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
[2025-07-27T19:30:48.456+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T180000, start_date=20250727T193018, end_date=20250727T193048
[2025-07-27T19:30:48.512+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload ('str' object has no attribute 'strftime'; 783)
[2025-07-27T19:30:48.995+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T19:30:49.027+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T19:30:49.034+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T19:44:10.730+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T19:44:10.770+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:44:10.778+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:44:10.779+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T19:44:10.794+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 18:00:00+00:00
[2025-07-27T19:44:10.811+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T18:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpkoj4t27b']
[2025-07-27T19:44:10.813+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=795) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T19:44:10.815+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T19:44:10.816+0000] {standard_task_runner.py:63} INFO - Started process 812 to run task
[2025-07-27T19:44:10.873+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T19:44:10.925+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [running]> on host d1e83e43e29f
[2025-07-27T19:44:11.087+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T18:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T18:00:00+00:00'
[2025-07-27T19:44:11.088+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T19:44:11.102+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T19:44:11.103+0000] {ingestion_inference.py:65} INFO - [DEBUG] Execution date: 2025-07-27 18:00:00+00:00 (type=<class 'Proxy'>)
[2025-07-27T19:44:11.122+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T19:44:11.123+0000] {ingestion_inference.py:73} INFO - === Début du préprocessing ===
[2025-07-27T19:44:11.384+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 19:44:11.132736 to 2025-06-28 20:44:11.132736
[2025-07-27T19:44:11.597+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 20:44:11.132736 to 2025-06-29 21:44:11.132736
[2025-07-27T19:44:12.100+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 21:44:11.132736 to 2025-06-30 22:44:11.132736
[2025-07-27T19:44:13.108+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 22:44:11.132736 to 2025-07-01 23:44:11.132736
[2025-07-27T19:44:13.316+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 23:44:11.132736 to 2025-07-03 00:44:11.132736
[2025-07-27T19:44:14.411+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 00:44:11.132736 to 2025-07-04 01:44:11.132736
[2025-07-27T19:44:14.593+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 01:44:11.132736 to 2025-07-05 02:44:11.132736
[2025-07-27T19:44:14.813+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 02:44:11.132736 to 2025-07-06 03:44:11.132736
[2025-07-27T19:44:15.287+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 03:44:11.132736 to 2025-07-07 04:44:11.132736
[2025-07-27T19:44:15.831+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 04:44:11.132736 to 2025-07-08 05:44:11.132736
[2025-07-27T19:44:16.071+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 05:44:11.132736 to 2025-07-09 06:44:11.132736
[2025-07-27T19:44:16.297+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 06:44:11.132736 to 2025-07-10 07:44:11.132736
[2025-07-27T19:44:16.549+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 07:44:11.132736 to 2025-07-11 08:44:11.132736
[2025-07-27T19:44:16.738+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 08:44:11.132736 to 2025-07-12 09:44:11.132736
[2025-07-27T19:44:19.969+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 09:44:11.132736 to 2025-07-13 10:44:11.132736
[2025-07-27T19:44:20.426+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 10:44:11.132736 to 2025-07-14 11:44:11.132736
[2025-07-27T19:44:20.912+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 11:44:11.132736 to 2025-07-15 12:44:11.132736
[2025-07-27T19:44:21.109+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 12:44:11.132736 to 2025-07-16 13:44:11.132736
[2025-07-27T19:44:21.370+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 13:44:11.132736 to 2025-07-17 14:44:11.132736
[2025-07-27T19:44:21.584+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 14:44:11.132736 to 2025-07-18 15:44:11.132736
[2025-07-27T19:44:21.801+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 15:44:11.132736 to 2025-07-19 16:44:11.132736
[2025-07-27T19:44:21.990+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 16:44:11.132736 to 2025-07-20 17:44:11.132736
[2025-07-27T19:44:22.424+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 17:44:11.132736 to 2025-07-21 18:44:11.132736
[2025-07-27T19:44:22.639+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 18:44:11.132736 to 2025-07-22 19:44:11.132736
[2025-07-27T19:44:23.072+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 19:44:11.132736 to 2025-07-23 20:44:11.132736
[2025-07-27T19:44:23.289+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 20:44:11.132736 to 2025-07-24 21:44:11.132736
[2025-07-27T19:44:23.555+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 21:44:11.132736 to 2025-07-25 22:44:11.132736
[2025-07-27T19:44:23.792+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 22:44:11.132736 to 2025-07-26 23:44:11.132736
[2025-07-27T19:44:24.232+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 23:44:11.132736 to 2025-07-27 19:44:11.132736
[2025-07-27T19:44:24.458+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727194424.csv
[2025-07-27T19:44:24.889+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 19:44:11.132736 to 2025-06-28 20:44:11.132736
[2025-07-27T19:44:25.109+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 20:44:11.132736 to 2025-06-29 21:44:11.132736
[2025-07-27T19:44:25.322+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 21:44:11.132736 to 2025-06-30 22:44:11.132736
[2025-07-27T19:44:25.517+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 22:44:11.132736 to 2025-07-01 23:44:11.132736
[2025-07-27T19:44:25.737+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 23:44:11.132736 to 2025-07-03 00:44:11.132736
[2025-07-27T19:44:25.955+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 00:44:11.132736 to 2025-07-04 01:44:11.132736
[2025-07-27T19:44:26.243+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 01:44:11.132736 to 2025-07-05 02:44:11.132736
[2025-07-27T19:44:27.149+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 02:44:11.132736 to 2025-07-06 03:44:11.132736
[2025-07-27T19:44:27.755+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 03:44:11.132736 to 2025-07-07 04:44:11.132736
[2025-07-27T19:44:27.987+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 04:44:11.132736 to 2025-07-08 05:44:11.132736
[2025-07-27T19:44:28.209+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 05:44:11.132736 to 2025-07-09 06:44:11.132736
[2025-07-27T19:44:28.445+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 06:44:11.132736 to 2025-07-10 07:44:11.132736
[2025-07-27T19:44:28.632+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 07:44:11.132736 to 2025-07-11 08:44:11.132736
[2025-07-27T19:44:28.838+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 08:44:11.132736 to 2025-07-12 09:44:11.132736
[2025-07-27T19:44:29.080+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 09:44:11.132736 to 2025-07-13 10:44:11.132736
[2025-07-27T19:44:29.292+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 10:44:11.132736 to 2025-07-14 11:44:11.132736
[2025-07-27T19:44:29.493+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 11:44:11.132736 to 2025-07-15 12:44:11.132736
[2025-07-27T19:44:29.736+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 12:44:11.132736 to 2025-07-16 13:44:11.132736
[2025-07-27T19:44:30.007+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 13:44:11.132736 to 2025-07-17 14:44:11.132736
[2025-07-27T19:44:30.217+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 14:44:11.132736 to 2025-07-18 15:44:11.132736
[2025-07-27T19:44:30.662+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 15:44:11.132736 to 2025-07-19 16:44:11.132736
[2025-07-27T19:44:30.894+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 16:44:11.132736 to 2025-07-20 17:44:11.132736
[2025-07-27T19:44:33.477+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 17:44:11.132736 to 2025-07-21 18:44:11.132736
[2025-07-27T19:44:33.891+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 18:44:11.132736 to 2025-07-22 19:44:11.132736
[2025-07-27T19:44:34.090+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 19:44:11.132736 to 2025-07-23 20:44:11.132736
[2025-07-27T19:44:35.045+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 20:44:11.132736 to 2025-07-24 21:44:11.132736
[2025-07-27T19:44:36.622+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 21:44:11.132736 to 2025-07-25 22:44:11.132736
[2025-07-27T19:44:37.179+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 22:44:11.132736 to 2025-07-26 23:44:11.132736
[2025-07-27T19:44:38.373+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 23:44:11.132736 to 2025-07-27 19:44:11.132736
[2025-07-27T19:44:38.552+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727194438.csv
[2025-07-27T19:44:38.553+0000] {ingestion_inference.py:78} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T19:44:38.554+0000] {ingestion_inference.py:79} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T19:44:38.618+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727193956.csv
[2025-07-27T19:44:38.663+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727194424.csv
[2025-07-27T19:44:38.671+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T19:44:38.672+0000] {ingestion_inference.py:83} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T19:44:38.874+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T19:44:38.875+0000] {ingestion_inference.py:86} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T19:44:38.926+0000] {ingestion_inference.py:90} INFO - Scaler chargé : StandardScaler()
[2025-07-27T19:44:38.942+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-27T19:44:38.959+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-27T19:44:38.960+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-27T19:44:38.982+0000] {ingestion_inference.py:102} INFO - Extraction dernière ligne : shape=(1, 81)
[2025-07-27T19:44:39.070+0000] {ingestion_inference.py:113} INFO - ✅ Uploaded to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=18/features.parquet
[2025-07-27T19:44:39.071+0000] {ingestion_inference.py:115} INFO - === Fin du préprocessing ===
[2025-07-27T19:44:39.075+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T19:44:39.076+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T19:44:39.093+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T180000, start_date=20250727T194410, end_date=20250727T194439
[2025-07-27T19:44:39.205+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T19:44:39.230+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T19:44:39.233+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T19:51:19.472+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T19:51:19.543+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:51:19.553+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [queued]>
[2025-07-27T19:51:19.554+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T19:51:19.807+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 18:00:00+00:00
[2025-07-27T19:51:19.823+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T18:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpo6lzi1lp']
[2025-07-27T19:51:19.825+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=675) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T19:51:19.826+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T19:51:19.827+0000] {standard_task_runner.py:63} INFO - Started process 692 to run task
[2025-07-27T19:51:19.843+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T19:51:19.884+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T18:00:00+00:00 [running]> on host ad1b488300d1
[2025-07-27T19:51:20.015+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T18:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T18:00:00+00:00'
[2025-07-27T19:51:20.017+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T19:51:20.032+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T19:51:20.033+0000] {ingestion_inference.py:65} INFO - [DEBUG] Execution date: 2025-07-27 18:00:00+00:00 (type=<class 'Proxy'>)
[2025-07-27T19:51:20.047+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T19:51:20.047+0000] {ingestion_inference.py:73} INFO - === Début du préprocessing ===
[2025-07-27T19:51:20.278+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 19:51:20.056978 to 2025-06-28 20:51:20.056978
[2025-07-27T19:51:20.623+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 20:51:20.056978 to 2025-06-29 21:51:20.056978
[2025-07-27T19:51:22.120+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 21:51:20.056978 to 2025-06-30 22:51:20.056978
[2025-07-27T19:51:22.353+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 22:51:20.056978 to 2025-07-01 23:51:20.056978
[2025-07-27T19:51:22.531+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 23:51:20.056978 to 2025-07-03 00:51:20.056978
[2025-07-27T19:51:22.758+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 00:51:20.056978 to 2025-07-04 01:51:20.056978
[2025-07-27T19:51:22.933+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 01:51:20.056978 to 2025-07-05 02:51:20.056978
[2025-07-27T19:51:23.137+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 02:51:20.056978 to 2025-07-06 03:51:20.056978
[2025-07-27T19:51:23.347+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 03:51:20.056978 to 2025-07-07 04:51:20.056978
[2025-07-27T19:51:23.550+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 04:51:20.056978 to 2025-07-08 05:51:20.056978
[2025-07-27T19:51:23.991+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 05:51:20.056978 to 2025-07-09 06:51:20.056978
[2025-07-27T19:51:25.549+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 06:51:20.056978 to 2025-07-10 07:51:20.056978
[2025-07-27T19:51:25.784+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 07:51:20.056978 to 2025-07-11 08:51:20.056978
[2025-07-27T19:51:26.368+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 08:51:20.056978 to 2025-07-12 09:51:20.056978
[2025-07-27T19:51:26.558+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 09:51:20.056978 to 2025-07-13 10:51:20.056978
[2025-07-27T19:51:26.771+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 10:51:20.056978 to 2025-07-14 11:51:20.056978
[2025-07-27T19:51:27.193+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 11:51:20.056978 to 2025-07-15 12:51:20.056978
[2025-07-27T19:51:27.702+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 12:51:20.056978 to 2025-07-16 13:51:20.056978
[2025-07-27T19:51:27.930+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 13:51:20.056978 to 2025-07-17 14:51:20.056978
[2025-07-27T19:51:28.144+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 14:51:20.056978 to 2025-07-18 15:51:20.056978
[2025-07-27T19:51:28.776+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 15:51:20.056978 to 2025-07-19 16:51:20.056978
[2025-07-27T19:51:29.396+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 16:51:20.056978 to 2025-07-20 17:51:20.056978
[2025-07-27T19:51:29.623+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 17:51:20.056978 to 2025-07-21 18:51:20.056978
[2025-07-27T19:51:29.841+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 18:51:20.056978 to 2025-07-22 19:51:20.056978
[2025-07-27T19:51:31.448+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 19:51:20.056978 to 2025-07-23 20:51:20.056978
[2025-07-27T19:51:31.747+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 20:51:20.056978 to 2025-07-24 21:51:20.056978
[2025-07-27T19:51:32.240+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 21:51:20.056978 to 2025-07-25 22:51:20.056978
[2025-07-27T19:51:32.742+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 22:51:20.056978 to 2025-07-26 23:51:20.056978
[2025-07-27T19:51:32.919+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 23:51:20.056978 to 2025-07-27 19:51:20.056978
[2025-07-27T19:51:33.144+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727195132.csv
[2025-07-27T19:51:34.062+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 19:51:20.056978 to 2025-06-28 20:51:20.056978
[2025-07-27T19:51:34.269+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 20:51:20.056978 to 2025-06-29 21:51:20.056978
[2025-07-27T19:51:34.701+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 21:51:20.056978 to 2025-06-30 22:51:20.056978
[2025-07-27T19:51:35.222+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 22:51:20.056978 to 2025-07-01 23:51:20.056978
[2025-07-27T19:51:37.375+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 23:51:20.056978 to 2025-07-03 00:51:20.056978
[2025-07-27T19:51:37.861+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 00:51:20.056978 to 2025-07-04 01:51:20.056978
[2025-07-27T19:51:38.114+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 01:51:20.056978 to 2025-07-05 02:51:20.056978
[2025-07-27T19:51:38.303+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 02:51:20.056978 to 2025-07-06 03:51:20.056978
[2025-07-27T19:51:38.516+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 03:51:20.056978 to 2025-07-07 04:51:20.056978
[2025-07-27T19:51:38.717+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 04:51:20.056978 to 2025-07-08 05:51:20.056978
[2025-07-27T19:51:39.204+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 05:51:20.056978 to 2025-07-09 06:51:20.056978
[2025-07-27T19:51:39.432+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 06:51:20.056978 to 2025-07-10 07:51:20.056978
[2025-07-27T19:51:42.517+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 07:51:20.056978 to 2025-07-11 08:51:20.056978
[2025-07-27T19:51:42.731+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 08:51:20.056978 to 2025-07-12 09:51:20.056978
[2025-07-27T19:51:43.411+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 09:51:20.056978 to 2025-07-13 10:51:20.056978
[2025-07-27T19:51:41.776+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 10:51:20.056978 to 2025-07-14 11:51:20.056978
[2025-07-27T19:51:41.956+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 11:51:20.056978 to 2025-07-15 12:51:20.056978
[2025-07-27T19:51:42.180+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 12:51:20.056978 to 2025-07-16 13:51:20.056978
[2025-07-27T19:51:42.388+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 13:51:20.056978 to 2025-07-17 14:51:20.056978
[2025-07-27T19:51:42.566+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 14:51:20.056978 to 2025-07-18 15:51:20.056978
[2025-07-27T19:51:42.746+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 15:51:20.056978 to 2025-07-19 16:51:20.056978
[2025-07-27T19:51:42.961+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 16:51:20.056978 to 2025-07-20 17:51:20.056978
[2025-07-27T19:51:43.452+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 17:51:20.056978 to 2025-07-21 18:51:20.056978
[2025-07-27T19:51:44.717+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 18:51:20.056978 to 2025-07-22 19:51:20.056978
[2025-07-27T19:51:45.204+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 19:51:20.056978 to 2025-07-23 20:51:20.056978
[2025-07-27T19:51:45.410+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 20:51:20.056978 to 2025-07-24 21:51:20.056978
[2025-07-27T19:51:45.602+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 21:51:20.056978 to 2025-07-25 22:51:20.056978
[2025-07-27T19:51:45.821+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 22:51:20.056978 to 2025-07-26 23:51:20.056978
[2025-07-27T19:51:46.223+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 23:51:20.056978 to 2025-07-27 19:51:20.056978
[2025-07-27T19:51:46.362+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727195146.csv
[2025-07-27T19:51:46.363+0000] {ingestion_inference.py:78} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T19:51:46.364+0000] {ingestion_inference.py:79} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T19:51:46.481+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727194957.csv
[2025-07-27T19:51:46.528+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727195132.csv
[2025-07-27T19:51:46.537+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T19:51:46.539+0000] {ingestion_inference.py:83} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T19:51:46.751+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T19:51:46.752+0000] {ingestion_inference.py:86} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T19:51:46.770+0000] {ingestion_inference.py:90} INFO - Scaler chargé : StandardScaler()
[2025-07-27T19:51:46.786+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-27T19:51:46.803+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-27T19:51:46.804+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-27T19:51:46.819+0000] {ingestion_inference.py:102} INFO - Extraction dernière ligne : shape=(1, 81)
[2025-07-27T19:51:46.883+0000] {ingestion_inference.py:113} INFO - ✅ Uploaded to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=18/features.parquet
[2025-07-27T19:51:46.884+0000] {ingestion_inference.py:115} INFO - === Fin du préprocessing ===
[2025-07-27T19:51:46.887+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T19:51:46.888+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T19:51:46.905+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T180000, start_date=20250727T195119, end_date=20250727T195146
[2025-07-27T19:51:46.964+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T19:51:46.992+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T19:51:47.028+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
