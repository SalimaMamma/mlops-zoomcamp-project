[2025-07-27T16:10:17.716+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T16:10:17.750+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:10:17.758+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:10:17.759+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T16:10:17.961+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 15:00:00+00:00
[2025-07-27T16:10:17.976+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=1781) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T16:10:17.976+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T15:00:00+00:00', '--job-id', '11', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpzxv9rlfi']
[2025-07-27T16:10:17.977+0000] {standard_task_runner.py:63} INFO - Started process 1798 to run task
[2025-07-27T16:10:17.978+0000] {standard_task_runner.py:91} INFO - Job 11: Subtask preprocess_and_upload
[2025-07-27T16:10:17.992+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T16:10:18.033+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [running]> on host 50590821b8ff
[2025-07-27T16:10:18.121+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T15:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T15:00:00+00:00'
[2025-07-27T16:10:18.122+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T16:10:18.149+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T16:10:18.329+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 16:10:18.159777 to 2025-06-28 17:10:18.159777
[2025-07-27T16:10:18.567+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 17:10:18.159777 to 2025-06-29 18:10:18.159777
[2025-07-27T16:10:18.744+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 18:10:18.159777 to 2025-06-30 19:10:18.159777
[2025-07-27T16:10:18.921+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 19:10:18.159777 to 2025-07-01 20:10:18.159777
[2025-07-27T16:10:19.121+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 20:10:18.159777 to 2025-07-02 21:10:18.159777
[2025-07-27T16:10:19.324+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 21:10:18.159777 to 2025-07-03 22:10:18.159777
[2025-07-27T16:10:19.535+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 22:10:18.159777 to 2025-07-04 23:10:18.159777
[2025-07-27T16:10:19.704+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 23:10:18.159777 to 2025-07-06 00:10:18.159777
[2025-07-27T16:10:19.901+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 00:10:18.159777 to 2025-07-07 01:10:18.159777
[2025-07-27T16:10:20.099+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 01:10:18.159777 to 2025-07-08 02:10:18.159777
[2025-07-27T16:10:20.520+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 02:10:18.159777 to 2025-07-09 03:10:18.159777
[2025-07-27T16:10:20.704+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 03:10:18.159777 to 2025-07-10 04:10:18.159777
[2025-07-27T16:10:20.926+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 04:10:18.159777 to 2025-07-11 05:10:18.159777
[2025-07-27T16:10:21.652+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 05:10:18.159777 to 2025-07-12 06:10:18.159777
[2025-07-27T16:10:21.833+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 06:10:18.159777 to 2025-07-13 07:10:18.159777
[2025-07-27T16:10:22.041+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 07:10:18.159777 to 2025-07-14 08:10:18.159777
[2025-07-27T16:10:22.254+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 08:10:18.159777 to 2025-07-15 09:10:18.159777
[2025-07-27T16:10:23.183+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 09:10:18.159777 to 2025-07-16 10:10:18.159777
[2025-07-27T16:10:23.350+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 10:10:18.159777 to 2025-07-17 11:10:18.159777
[2025-07-27T16:10:23.832+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 11:10:18.159777 to 2025-07-18 12:10:18.159777
[2025-07-27T16:10:24.024+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 12:10:18.159777 to 2025-07-19 13:10:18.159777
[2025-07-27T16:10:24.209+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 13:10:18.159777 to 2025-07-20 14:10:18.159777
[2025-07-27T16:10:25.208+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 14:10:18.159777 to 2025-07-21 15:10:18.159777
[2025-07-27T16:10:25.390+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 15:10:18.159777 to 2025-07-22 16:10:18.159777
[2025-07-27T16:10:25.760+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 16:10:18.159777 to 2025-07-23 17:10:18.159777
[2025-07-27T16:10:25.936+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 17:10:18.159777 to 2025-07-24 18:10:18.159777
[2025-07-27T16:10:26.112+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 18:10:18.159777 to 2025-07-25 19:10:18.159777
[2025-07-27T16:10:26.607+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 19:10:18.159777 to 2025-07-26 20:10:18.159777
[2025-07-27T16:10:26.806+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 20:10:18.159777 to 2025-07-27 16:10:18.159777
[2025-07-27T16:10:26.895+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727161026.csv
[2025-07-27T16:10:27.102+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 16:10:18.159777 to 2025-06-28 17:10:18.159777
[2025-07-27T16:10:27.600+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 17:10:18.159777 to 2025-06-29 18:10:18.159777
[2025-07-27T16:10:27.789+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 18:10:18.159777 to 2025-06-30 19:10:18.159777
[2025-07-27T16:10:27.984+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 19:10:18.159777 to 2025-07-01 20:10:18.159777
[2025-07-27T16:10:28.154+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 20:10:18.159777 to 2025-07-02 21:10:18.159777
[2025-07-27T16:10:28.327+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 21:10:18.159777 to 2025-07-03 22:10:18.159777
[2025-07-27T16:10:28.522+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 22:10:18.159777 to 2025-07-04 23:10:18.159777
[2025-07-27T16:10:28.827+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 23:10:18.159777 to 2025-07-06 00:10:18.159777
[2025-07-27T16:10:29.025+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 00:10:18.159777 to 2025-07-07 01:10:18.159777
[2025-07-27T16:10:29.437+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 01:10:18.159777 to 2025-07-08 02:10:18.159777
[2025-07-27T16:10:29.724+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 02:10:18.159777 to 2025-07-09 03:10:18.159777
[2025-07-27T16:10:30.669+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 03:10:18.159777 to 2025-07-10 04:10:18.159777
[2025-07-27T16:10:30.861+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 04:10:18.159777 to 2025-07-11 05:10:18.159777
[2025-07-27T16:10:31.039+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 05:10:18.159777 to 2025-07-12 06:10:18.159777
[2025-07-27T16:10:31.261+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 06:10:18.159777 to 2025-07-13 07:10:18.159777
[2025-07-27T16:10:31.430+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 07:10:18.159777 to 2025-07-14 08:10:18.159777
[2025-07-27T16:10:31.604+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 08:10:18.159777 to 2025-07-15 09:10:18.159777
[2025-07-27T16:10:32.013+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 09:10:18.159777 to 2025-07-16 10:10:18.159777
[2025-07-27T16:10:32.229+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 10:10:18.159777 to 2025-07-17 11:10:18.159777
[2025-07-27T16:10:32.447+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 11:10:18.159777 to 2025-07-18 12:10:18.159777
[2025-07-27T16:10:32.865+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 12:10:18.159777 to 2025-07-19 13:10:18.159777
[2025-07-27T16:10:33.074+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 13:10:18.159777 to 2025-07-20 14:10:18.159777
[2025-07-27T16:10:33.281+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 14:10:18.159777 to 2025-07-21 15:10:18.159777
[2025-07-27T16:10:33.472+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 15:10:18.159777 to 2025-07-22 16:10:18.159777
[2025-07-27T16:10:33.642+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 16:10:18.159777 to 2025-07-23 17:10:18.159777
[2025-07-27T16:10:33.844+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 17:10:18.159777 to 2025-07-24 18:10:18.159777
[2025-07-27T16:10:34.050+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 18:10:18.159777 to 2025-07-25 19:10:18.159777
[2025-07-27T16:10:34.249+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 19:10:18.159777 to 2025-07-26 20:10:18.159777
[2025-07-27T16:10:34.427+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 20:10:18.159777 to 2025-07-27 16:10:18.159777
[2025-07-27T16:10:34.505+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727161034.csv
[2025-07-27T16:10:34.544+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727155723.csv
[2025-07-27T16:10:34.569+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727155848.csv
[2025-07-27T16:10:34.592+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727160409.csv
[2025-07-27T16:10:34.616+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727160429.csv
[2025-07-27T16:10:34.643+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727160946.csv
[2025-07-27T16:10:34.665+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727161026.csv
[2025-07-27T16:10:34.673+0000] {data_processing.py:84} INFO - Combined 8643 records for BTC-USD
[2025-07-27T16:10:34.772+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8593, 84)
[2025-07-27T16:10:34.785+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T16:10:34.786+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 76, in preprocess_and_upload
    X_scaled = processor.scaler.transform(X)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/preprocessing/_data.py", line 1045, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/base.py", line 608, in _validate_data
    self._check_feature_names(X, reset=reset)
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/base.py", line 535, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- atr
- bbands_lower
- bbands_position
- bbands_upper
- close_lag_1
- ...

[2025-07-27T16:10:34.806+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T150000, start_date=20250727T161017, end_date=20250727T161034
[2025-07-27T16:10:34.822+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 11 for task preprocess_and_upload (The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- atr
- bbands_lower
- bbands_position
- bbands_upper
- close_lag_1
- ...
; 1798)
[2025-07-27T16:10:34.875+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T16:10:34.901+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T16:10:34.904+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T16:15:39.925+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T16:15:39.964+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:15:39.974+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:15:39.975+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T16:15:40.186+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 15:00:00+00:00
[2025-07-27T16:15:40.202+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=530) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T16:15:40.200+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T15:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpae3so12x']
[2025-07-27T16:15:40.204+0000] {standard_task_runner.py:63} INFO - Started process 547 to run task
[2025-07-27T16:15:40.204+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T16:15:40.223+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T16:15:40.279+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [running]> on host 9a3567bd8f1b
[2025-07-27T16:15:40.396+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T15:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T15:00:00+00:00'
[2025-07-27T16:15:40.398+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T16:15:40.435+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T16:15:40.436+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T16:15:40.691+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 16:15:40.449815 to 2025-06-28 17:15:40.449815
[2025-07-27T16:15:40.925+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 17:15:40.449815 to 2025-06-29 18:15:40.449815
[2025-07-27T16:15:41.137+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 18:15:40.449815 to 2025-06-30 19:15:40.449815
[2025-07-27T16:15:41.386+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 19:15:40.449815 to 2025-07-01 20:15:40.449815
[2025-07-27T16:15:41.820+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 20:15:40.449815 to 2025-07-02 21:15:40.449815
[2025-07-27T16:15:41.996+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 21:15:40.449815 to 2025-07-03 22:15:40.449815
[2025-07-27T16:15:42.171+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 22:15:40.449815 to 2025-07-04 23:15:40.449815
[2025-07-27T16:15:42.464+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 23:15:40.449815 to 2025-07-06 00:15:40.449815
[2025-07-27T16:15:42.897+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 00:15:40.449815 to 2025-07-07 01:15:40.449815
[2025-07-27T16:15:43.314+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 01:15:40.449815 to 2025-07-08 02:15:40.449815
[2025-07-27T16:15:43.524+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 02:15:40.449815 to 2025-07-09 03:15:40.449815
[2025-07-27T16:15:44.099+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 03:15:40.449815 to 2025-07-10 04:15:40.449815
[2025-07-27T16:15:44.573+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 04:15:40.449815 to 2025-07-11 05:15:40.449815
[2025-07-27T16:15:45.010+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 05:15:40.449815 to 2025-07-12 06:15:40.449815
[2025-07-27T16:15:45.491+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 06:15:40.449815 to 2025-07-13 07:15:40.449815
[2025-07-27T16:15:45.669+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 07:15:40.449815 to 2025-07-14 08:15:40.449815
[2025-07-27T16:15:45.850+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 08:15:40.449815 to 2025-07-15 09:15:40.449815
[2025-07-27T16:15:46.030+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 09:15:40.449815 to 2025-07-16 10:15:40.449815
[2025-07-27T16:15:46.234+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 10:15:40.449815 to 2025-07-17 11:15:40.449815
[2025-07-27T16:15:46.483+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 11:15:40.449815 to 2025-07-18 12:15:40.449815
[2025-07-27T16:15:46.895+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 12:15:40.449815 to 2025-07-19 13:15:40.449815
[2025-07-27T16:15:47.352+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 13:15:40.449815 to 2025-07-20 14:15:40.449815
[2025-07-27T16:15:47.554+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 14:15:40.449815 to 2025-07-21 15:15:40.449815
[2025-07-27T16:15:47.767+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 15:15:40.449815 to 2025-07-22 16:15:40.449815
[2025-07-27T16:15:47.961+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 16:15:40.449815 to 2025-07-23 17:15:40.449815
[2025-07-27T16:15:48.176+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 17:15:40.449815 to 2025-07-24 18:15:40.449815
[2025-07-27T16:15:48.375+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 18:15:40.449815 to 2025-07-25 19:15:40.449815
[2025-07-27T16:15:48.579+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 19:15:40.449815 to 2025-07-26 20:15:40.449815
[2025-07-27T16:15:48.741+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 20:15:40.449815 to 2025-07-27 16:15:40.449815
[2025-07-27T16:15:48.940+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727161548.csv
[2025-07-27T16:15:49.121+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 16:15:40.449815 to 2025-06-28 17:15:40.449815
[2025-07-27T16:15:49.292+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 17:15:40.449815 to 2025-06-29 18:15:40.449815
[2025-07-27T16:15:49.702+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 18:15:40.449815 to 2025-06-30 19:15:40.449815
[2025-07-27T16:15:49.887+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 19:15:40.449815 to 2025-07-01 20:15:40.449815
[2025-07-27T16:15:50.092+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 20:15:40.449815 to 2025-07-02 21:15:40.449815
[2025-07-27T16:15:50.586+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 21:15:40.449815 to 2025-07-03 22:15:40.449815
[2025-07-27T16:15:50.845+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 22:15:40.449815 to 2025-07-04 23:15:40.449815
[2025-07-27T16:15:51.022+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 23:15:40.449815 to 2025-07-06 00:15:40.449815
[2025-07-27T16:15:51.234+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 00:15:40.449815 to 2025-07-07 01:15:40.449815
[2025-07-27T16:15:51.451+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 01:15:40.449815 to 2025-07-08 02:15:40.449815
[2025-07-27T16:15:50.007+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 02:15:40.449815 to 2025-07-09 03:15:40.449815
[2025-07-27T16:15:50.431+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 03:15:40.449815 to 2025-07-10 04:15:40.449815
[2025-07-27T16:15:50.634+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 04:15:40.449815 to 2025-07-11 05:15:40.449815
[2025-07-27T16:15:50.958+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 05:15:40.449815 to 2025-07-12 06:15:40.449815
[2025-07-27T16:15:51.369+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 06:15:40.449815 to 2025-07-13 07:15:40.449815
[2025-07-27T16:15:51.943+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 07:15:40.449815 to 2025-07-14 08:15:40.449815
[2025-07-27T16:15:52.308+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 08:15:40.449815 to 2025-07-15 09:15:40.449815
[2025-07-27T16:15:52.503+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 09:15:40.449815 to 2025-07-16 10:15:40.449815
[2025-07-27T16:15:52.923+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 10:15:40.449815 to 2025-07-17 11:15:40.449815
[2025-07-27T16:15:53.117+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 11:15:40.449815 to 2025-07-18 12:15:40.449815
[2025-07-27T16:15:53.318+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 12:15:40.449815 to 2025-07-19 13:15:40.449815
[2025-07-27T16:15:53.741+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 13:15:40.449815 to 2025-07-20 14:15:40.449815
[2025-07-27T16:15:53.942+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 14:15:40.449815 to 2025-07-21 15:15:40.449815
[2025-07-27T16:15:54.123+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 15:15:40.449815 to 2025-07-22 16:15:40.449815
[2025-07-27T16:15:54.319+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 16:15:40.449815 to 2025-07-23 17:15:40.449815
[2025-07-27T16:15:54.730+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 17:15:40.449815 to 2025-07-24 18:15:40.449815
[2025-07-27T16:15:55.135+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 18:15:40.449815 to 2025-07-25 19:15:40.449815
[2025-07-27T16:15:55.343+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 19:15:40.449815 to 2025-07-26 20:15:40.449815
[2025-07-27T16:15:55.558+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 20:15:40.449815 to 2025-07-27 16:15:40.449815
[2025-07-27T16:15:55.642+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727161555.csv
[2025-07-27T16:15:55.642+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T16:15:55.644+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T16:15:55.686+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727161424.csv
[2025-07-27T16:15:55.709+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727161548.csv
[2025-07-27T16:15:55.714+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T16:15:55.715+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T16:15:55.715+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T16:15:55.830+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T16:15:55.831+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T16:15:55.832+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T16:15:55.846+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T16:15:55.846+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['open', 'high', 'low', 'close', 'volume']
[2025-07-27T16:15:55.848+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['open', 'high', 'low', 'close', 'volume']
[2025-07-27T16:15:55.848+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8590, 5)
[2025-07-27T16:15:55.849+0000] {ingestion_inference.py:98} ERROR - Erreur lors du scaling: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- atr
- bbands_lower
- bbands_position
- bbands_upper
- close_lag_1
- ...

[2025-07-27T16:15:55.850+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T16:15:55.850+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 94, in preprocess_and_upload
    X_scaled = processor.scaler.transform(X)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/preprocessing/_data.py", line 1045, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/base.py", line 608, in _validate_data
    self._check_feature_names(X, reset=reset)
  File "/home/airflow/.local/lib/python3.12/site-packages/sklearn/base.py", line 535, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- atr
- bbands_lower
- bbands_position
- bbands_upper
- close_lag_1
- ...

[2025-07-27T16:15:55.868+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T150000, start_date=20250727T161539, end_date=20250727T161555
[2025-07-27T16:15:55.890+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload (The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- atr
- bbands_lower
- bbands_position
- bbands_upper
- close_lag_1
- ...
; 547)
[2025-07-27T16:15:55.928+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T16:15:55.946+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T16:15:55.950+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T16:25:06.590+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T16:25:06.625+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:25:06.635+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [queued]>
[2025-07-27T16:25:06.636+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T16:25:06.830+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 15:00:00+00:00
[2025-07-27T16:25:06.845+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=482) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T16:25:06.845+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T15:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpzrz677df']
[2025-07-27T16:25:06.847+0000] {standard_task_runner.py:63} INFO - Started process 499 to run task
[2025-07-27T16:25:06.848+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T16:25:06.867+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T16:25:06.911+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T15:00:00+00:00 [running]> on host 41a48031f8c4
[2025-07-27T16:25:07.008+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T15:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T15:00:00+00:00'
[2025-07-27T16:25:07.010+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T16:25:07.041+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T16:25:07.041+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T16:25:07.281+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 16:25:07.052397 to 2025-06-28 17:25:07.052397
[2025-07-27T16:25:07.485+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 17:25:07.052397 to 2025-06-29 18:25:07.052397
[2025-07-27T16:25:08.096+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 18:25:07.052397 to 2025-06-30 19:25:07.052397
[2025-07-27T16:25:08.291+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 19:25:07.052397 to 2025-07-01 20:25:07.052397
[2025-07-27T16:25:08.503+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 20:25:07.052397 to 2025-07-02 21:25:07.052397
[2025-07-27T16:25:08.716+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 21:25:07.052397 to 2025-07-03 22:25:07.052397
[2025-07-27T16:25:09.136+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 22:25:07.052397 to 2025-07-04 23:25:07.052397
[2025-07-27T16:25:09.353+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 23:25:07.052397 to 2025-07-06 00:25:07.052397
[2025-07-27T16:25:09.543+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 00:25:07.052397 to 2025-07-07 01:25:07.052397
[2025-07-27T16:25:09.968+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 01:25:07.052397 to 2025-07-08 02:25:07.052397
[2025-07-27T16:25:10.164+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 02:25:07.052397 to 2025-07-09 03:25:07.052397
[2025-07-27T16:25:10.678+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 03:25:07.052397 to 2025-07-10 04:25:07.052397
[2025-07-27T16:25:10.848+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 04:25:07.052397 to 2025-07-11 05:25:07.052397
[2025-07-27T16:25:11.338+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 05:25:07.052397 to 2025-07-12 06:25:07.052397
[2025-07-27T16:25:13.210+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 06:25:07.052397 to 2025-07-13 07:25:07.052397
[2025-07-27T16:25:13.418+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 07:25:07.052397 to 2025-07-14 08:25:07.052397
[2025-07-27T16:25:14.301+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 08:25:07.052397 to 2025-07-15 09:25:07.052397
[2025-07-27T16:25:14.785+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 09:25:07.052397 to 2025-07-16 10:25:07.052397
[2025-07-27T16:25:15.446+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 10:25:07.052397 to 2025-07-17 11:25:07.052397
[2025-07-27T16:25:15.912+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 11:25:07.052397 to 2025-07-18 12:25:07.052397
[2025-07-27T16:25:16.111+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 12:25:07.052397 to 2025-07-19 13:25:07.052397
[2025-07-27T16:25:16.406+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 13:25:07.052397 to 2025-07-20 14:25:07.052397
[2025-07-27T16:25:16.624+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 14:25:07.052397 to 2025-07-21 15:25:07.052397
[2025-07-27T16:25:16.815+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 15:25:07.052397 to 2025-07-22 16:25:07.052397
[2025-07-27T16:25:17.876+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 16:25:07.052397 to 2025-07-23 17:25:07.052397
[2025-07-27T16:25:18.647+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 17:25:07.052397 to 2025-07-24 18:25:07.052397
[2025-07-27T16:25:21.100+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 18:25:07.052397 to 2025-07-25 19:25:07.052397
[2025-07-27T16:25:21.284+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 19:25:07.052397 to 2025-07-26 20:25:07.052397
[2025-07-27T16:25:21.475+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 20:25:07.052397 to 2025-07-27 16:25:07.052397
[2025-07-27T16:25:21.691+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727162521.csv
[2025-07-27T16:25:22.174+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 16:25:07.052397 to 2025-06-28 17:25:07.052397
[2025-07-27T16:25:22.654+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 17:25:07.052397 to 2025-06-29 18:25:07.052397
[2025-07-27T16:25:22.824+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 18:25:07.052397 to 2025-06-30 19:25:07.052397
[2025-07-27T16:25:27.750+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 19:25:07.052397 to 2025-07-01 20:25:07.052397
[2025-07-27T16:25:27.951+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 20:25:07.052397 to 2025-07-02 21:25:07.052397
[2025-07-27T16:25:28.444+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 21:25:07.052397 to 2025-07-03 22:25:07.052397
[2025-07-27T16:25:28.660+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 22:25:07.052397 to 2025-07-04 23:25:07.052397
[2025-07-27T16:25:28.871+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 23:25:07.052397 to 2025-07-06 00:25:07.052397
[2025-07-27T16:25:29.120+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 00:25:07.052397 to 2025-07-07 01:25:07.052397
[2025-07-27T16:25:29.337+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 01:25:07.052397 to 2025-07-08 02:25:07.052397
[2025-07-27T16:25:29.767+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 02:25:07.052397 to 2025-07-09 03:25:07.052397
[2025-07-27T16:25:29.992+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 03:25:07.052397 to 2025-07-10 04:25:07.052397
[2025-07-27T16:25:30.188+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 04:25:07.052397 to 2025-07-11 05:25:07.052397
[2025-07-27T16:25:30.390+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 05:25:07.052397 to 2025-07-12 06:25:07.052397
[2025-07-27T16:25:30.571+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 06:25:07.052397 to 2025-07-13 07:25:07.052397
[2025-07-27T16:25:30.905+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 07:25:07.052397 to 2025-07-14 08:25:07.052397
[2025-07-27T16:25:31.113+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 08:25:07.052397 to 2025-07-15 09:25:07.052397
[2025-07-27T16:25:31.323+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 09:25:07.052397 to 2025-07-16 10:25:07.052397
[2025-07-27T16:25:31.956+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 10:25:07.052397 to 2025-07-17 11:25:07.052397
[2025-07-27T16:25:32.141+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 11:25:07.052397 to 2025-07-18 12:25:07.052397
[2025-07-27T16:25:32.404+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 12:25:07.052397 to 2025-07-19 13:25:07.052397
[2025-07-27T16:25:32.586+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 13:25:07.052397 to 2025-07-20 14:25:07.052397
[2025-07-27T16:25:32.766+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 14:25:07.052397 to 2025-07-21 15:25:07.052397
[2025-07-27T16:25:33.580+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 15:25:07.052397 to 2025-07-22 16:25:07.052397
[2025-07-27T16:25:33.811+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 16:25:07.052397 to 2025-07-23 17:25:07.052397
[2025-07-27T16:25:33.982+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 17:25:07.052397 to 2025-07-24 18:25:07.052397
[2025-07-27T16:25:34.175+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 18:25:07.052397 to 2025-07-25 19:25:07.052397
[2025-07-27T16:25:34.776+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 19:25:07.052397 to 2025-07-26 20:25:07.052397
[2025-07-27T16:25:35.008+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 20:25:07.052397 to 2025-07-27 16:25:07.052397
[2025-07-27T16:25:35.104+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727162535.csv
[2025-07-27T16:25:35.104+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T16:25:35.105+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T16:25:35.145+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727162413.csv
[2025-07-27T16:25:35.170+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727162521.csv
[2025-07-27T16:25:35.176+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T16:25:35.177+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T16:25:35.178+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T16:25:35.294+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T16:25:35.295+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T16:25:35.295+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T16:25:35.308+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T16:25:35.309+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T16:25:35.311+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T16:25:35.312+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8590, 80)
[2025-07-27T16:25:35.324+0000] {ingestion_inference.py:96} INFO - Shape des données après scaling : (8590, 80)
[2025-07-27T16:25:35.326+0000] {ingestion_inference.py:104} INFO - Extraction dernière ligne timestamp 8589 pour export : shape=(1, 80)
[2025-07-27T16:25:35.430+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T16:25:35.446+0000] {ingestion_inference.py:118} INFO - Uploaded features to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=15/features.parquet
[2025-07-27T16:25:35.447+0000] {ingestion_inference.py:120} INFO - === Fin du préprocessing ===
[2025-07-27T16:25:35.451+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T16:25:35.452+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T16:25:35.468+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T150000, start_date=20250727T162506, end_date=20250727T162535
[2025-07-27T16:25:35.518+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T16:25:35.539+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T16:25:35.541+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
