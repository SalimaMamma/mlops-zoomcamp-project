[2025-07-27T18:00:03.705+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T18:00:03.749+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:00:03.762+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:00:03.763+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T18:00:03.965+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 17:00:00+00:00
[2025-07-27T18:00:03.984+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T17:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpdsauhxtn']
[2025-07-27T18:00:03.986+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=2731) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T18:00:03.988+0000] {standard_task_runner.py:91} INFO - Job 10: Subtask preprocess_and_upload
[2025-07-27T18:00:03.988+0000] {standard_task_runner.py:63} INFO - Started process 2751 to run task
[2025-07-27T18:00:04.009+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T18:00:04.065+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [running]> on host 41a48031f8c4
[2025-07-27T18:00:04.213+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T17:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T17:00:00+00:00'
[2025-07-27T18:00:04.216+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T18:00:04.275+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T18:00:04.276+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T18:00:08.644+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 18:00:04.293534 to 2025-06-28 19:00:04.293534
[2025-07-27T18:00:08.854+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 19:00:04.293534 to 2025-06-29 20:00:04.293534
[2025-07-27T18:00:09.052+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 20:00:04.293534 to 2025-06-30 21:00:04.293534
[2025-07-27T18:00:09.240+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 21:00:04.293534 to 2025-07-01 22:00:04.293534
[2025-07-27T18:00:09.452+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 22:00:04.293534 to 2025-07-02 23:00:04.293534
[2025-07-27T18:00:09.960+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 23:00:04.293534 to 2025-07-04 00:00:04.293534
[2025-07-27T18:00:10.698+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 00:00:04.293534 to 2025-07-05 01:00:04.293534
[2025-07-27T18:00:11.110+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 01:00:04.293534 to 2025-07-06 02:00:04.293534
[2025-07-27T18:00:11.336+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 02:00:04.293534 to 2025-07-07 03:00:04.293534
[2025-07-27T18:00:11.520+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 03:00:04.293534 to 2025-07-08 04:00:04.293534
[2025-07-27T18:00:11.717+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 04:00:04.293534 to 2025-07-09 05:00:04.293534
[2025-07-27T18:00:20.407+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 05:00:04.293534 to 2025-07-10 06:00:04.293534
[2025-07-27T18:00:20.613+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 06:00:04.293534 to 2025-07-11 07:00:04.293534
[2025-07-27T18:00:20.820+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 07:00:04.293534 to 2025-07-12 08:00:04.293534
[2025-07-27T18:00:21.239+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 08:00:04.293534 to 2025-07-13 09:00:04.293534
[2025-07-27T18:00:21.446+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 09:00:04.293534 to 2025-07-14 10:00:04.293534
[2025-07-27T18:00:21.661+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 10:00:04.293534 to 2025-07-15 11:00:04.293534
[2025-07-27T18:00:22.767+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 11:00:04.293534 to 2025-07-16 12:00:04.293534
[2025-07-27T18:00:22.959+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 12:00:04.293534 to 2025-07-17 13:00:04.293534
[2025-07-27T18:00:23.450+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 13:00:04.293534 to 2025-07-18 14:00:04.293534
[2025-07-27T18:00:23.967+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 14:00:04.293534 to 2025-07-19 15:00:04.293534
[2025-07-27T18:00:24.169+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 15:00:04.293534 to 2025-07-20 16:00:04.293534
[2025-07-27T18:00:24.577+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 16:00:04.293534 to 2025-07-21 17:00:04.293534
[2025-07-27T18:00:24.995+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 17:00:04.293534 to 2025-07-22 18:00:04.293534
[2025-07-27T18:00:25.199+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 18:00:04.293534 to 2025-07-23 19:00:04.293534
[2025-07-27T18:00:26.372+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 19:00:04.293534 to 2025-07-24 20:00:04.293534
[2025-07-27T18:00:26.858+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 20:00:04.293534 to 2025-07-25 21:00:04.293534
[2025-07-27T18:00:27.055+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 21:00:04.293534 to 2025-07-26 22:00:04.293534
[2025-07-27T18:00:27.269+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 22:00:04.293534 to 2025-07-27 18:00:04.293534
[2025-07-27T18:00:27.408+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727180027.csv
[2025-07-27T18:00:27.611+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 18:00:04.293534 to 2025-06-28 19:00:04.293534
[2025-07-27T18:00:27.809+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 19:00:04.293534 to 2025-06-29 20:00:04.293534
[2025-07-27T18:00:27.987+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 20:00:04.293534 to 2025-06-30 21:00:04.293534
[2025-07-27T18:00:28.195+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 21:00:04.293534 to 2025-07-01 22:00:04.293534
[2025-07-27T18:00:29.383+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 22:00:04.293534 to 2025-07-02 23:00:04.293534
[2025-07-27T18:00:29.583+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 23:00:04.293534 to 2025-07-04 00:00:04.293534
[2025-07-27T18:00:29.783+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 00:00:04.293534 to 2025-07-05 01:00:04.293534
[2025-07-27T18:00:29.978+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 01:00:04.293534 to 2025-07-06 02:00:04.293534
[2025-07-27T18:00:30.169+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 02:00:04.293534 to 2025-07-07 03:00:04.293534
[2025-07-27T18:00:30.394+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 03:00:04.293534 to 2025-07-08 04:00:04.293534
[2025-07-27T18:00:30.597+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 04:00:04.293534 to 2025-07-09 05:00:04.293534
[2025-07-27T18:00:30.800+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 05:00:04.293534 to 2025-07-10 06:00:04.293534
[2025-07-27T18:00:31.218+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 06:00:04.293534 to 2025-07-11 07:00:04.293534
[2025-07-27T18:00:31.390+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 07:00:04.293534 to 2025-07-12 08:00:04.293534
[2025-07-27T18:00:31.607+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 08:00:04.293534 to 2025-07-13 09:00:04.293534
[2025-07-27T18:00:31.818+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 09:00:04.293534 to 2025-07-14 10:00:04.293534
[2025-07-27T18:00:31.998+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 10:00:04.293534 to 2025-07-15 11:00:04.293534
[2025-07-27T18:00:32.598+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 11:00:04.293534 to 2025-07-16 12:00:04.293534
[2025-07-27T18:00:32.811+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 12:00:04.293534 to 2025-07-17 13:00:04.293534
[2025-07-27T18:00:34.270+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 13:00:04.293534 to 2025-07-18 14:00:04.293534
[2025-07-27T18:00:34.495+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 14:00:04.293534 to 2025-07-19 15:00:04.293534
[2025-07-27T18:00:34.687+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 15:00:04.293534 to 2025-07-20 16:00:04.293534
[2025-07-27T18:00:35.174+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 16:00:04.293534 to 2025-07-21 17:00:04.293534
[2025-07-27T18:00:43.031+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 17:00:04.293534 to 2025-07-22 18:00:04.293534
[2025-07-27T18:00:43.239+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 18:00:04.293534 to 2025-07-23 19:00:04.293534
[2025-07-27T18:00:43.422+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 19:00:04.293534 to 2025-07-24 20:00:04.293534
[2025-07-27T18:00:43.855+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 20:00:04.293534 to 2025-07-25 21:00:04.293534
[2025-07-27T18:00:44.070+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 21:00:04.293534 to 2025-07-26 22:00:04.293534
[2025-07-27T18:00:44.231+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 22:00:04.293534 to 2025-07-27 18:00:04.293534
[2025-07-27T18:00:44.327+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727180044.csv
[2025-07-27T18:00:44.328+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T18:00:44.328+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:00:44.414+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727162413.csv
[2025-07-27T18:00:44.457+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727162521.csv
[2025-07-27T18:00:44.495+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727162546.csv
[2025-07-27T18:00:44.530+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727174238.csv
[2025-07-27T18:00:44.558+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727180027.csv
[2025-07-27T18:00:44.579+0000] {data_processing.py:84} INFO - Combined 8659 records for BTC-USD
[2025-07-27T18:00:44.581+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8659, 7)
[2025-07-27T18:00:44.581+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:00:44.741+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8609, 84)
[2025-07-27T18:00:44.742+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8609, 84)
[2025-07-27T18:00:44.743+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T18:00:44.758+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T18:00:44.759+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:00:44.762+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:00:44.763+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8609, 80)
[2025-07-27T18:00:44.778+0000] {ingestion_inference.py:96} INFO - Shape des données après scaling : (8609, 80)
[2025-07-27T18:00:44.779+0000] {ingestion_inference.py:104} INFO - Extraction dernière ligne timestamp 8608 pour export : shape=(1, 80)
[2025-07-27T18:00:44.839+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T18:00:44.860+0000] {ingestion_inference.py:118} INFO - Uploaded features to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=17/features.parquet
[2025-07-27T18:00:44.861+0000] {ingestion_inference.py:120} INFO - === Fin du préprocessing ===
[2025-07-27T18:00:44.865+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T18:00:44.866+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T18:00:44.880+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T170000, start_date=20250727T180003, end_date=20250727T180044
[2025-07-27T18:00:44.939+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T18:00:44.959+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T18:00:44.962+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T18:28:23.423+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T18:28:23.461+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:28:23.470+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:28:23.472+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T18:28:23.689+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 17:00:00+00:00
[2025-07-27T18:28:23.706+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=579) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T18:28:23.705+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T17:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpeo1q34db']
[2025-07-27T18:28:23.708+0000] {standard_task_runner.py:63} INFO - Started process 596 to run task
[2025-07-27T18:28:23.708+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T18:28:23.725+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T18:28:23.769+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [running]> on host ad22cb2f7f4c
[2025-07-27T18:28:23.947+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T17:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T17:00:00+00:00'
[2025-07-27T18:28:23.949+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T18:28:23.977+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T18:28:23.978+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T18:28:25.098+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 18:28:23.988148 to 2025-06-28 19:28:23.988148
[2025-07-27T18:28:25.590+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 19:28:23.988148 to 2025-06-29 20:28:23.988148
[2025-07-27T18:28:26.013+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 20:28:23.988148 to 2025-06-30 21:28:23.988148
[2025-07-27T18:28:26.659+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 21:28:23.988148 to 2025-07-01 22:28:23.988148
[2025-07-27T18:28:26.841+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 22:28:23.988148 to 2025-07-02 23:28:23.988148
[2025-07-27T18:28:28.222+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 23:28:23.988148 to 2025-07-04 00:28:23.988148
[2025-07-27T18:28:31.018+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 00:28:23.988148 to 2025-07-05 01:28:23.988148
[2025-07-27T18:28:31.291+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 01:28:23.988148 to 2025-07-06 02:28:23.988148
[2025-07-27T18:28:31.712+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 02:28:23.988148 to 2025-07-07 03:28:23.988148
[2025-07-27T18:28:32.207+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 03:28:23.988148 to 2025-07-08 04:28:23.988148
[2025-07-27T18:28:32.413+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 04:28:23.988148 to 2025-07-09 05:28:23.988148
[2025-07-27T18:28:32.617+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 05:28:23.988148 to 2025-07-10 06:28:23.988148
[2025-07-27T18:28:32.797+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 06:28:23.988148 to 2025-07-11 07:28:23.988148
[2025-07-27T18:28:32.969+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 07:28:23.988148 to 2025-07-12 08:28:23.988148
[2025-07-27T18:28:33.174+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 08:28:23.988148 to 2025-07-13 09:28:23.988148
[2025-07-27T18:28:34.278+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 09:28:23.988148 to 2025-07-14 10:28:23.988148
[2025-07-27T18:28:34.454+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 10:28:23.988148 to 2025-07-15 11:28:23.988148
[2025-07-27T18:28:34.659+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 11:28:23.988148 to 2025-07-16 12:28:23.988148
[2025-07-27T18:28:36.932+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 12:28:23.988148 to 2025-07-17 13:28:23.988148
[2025-07-27T18:28:37.134+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 13:28:23.988148 to 2025-07-18 14:28:23.988148
[2025-07-27T18:28:39.821+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 14:28:23.988148 to 2025-07-19 15:28:23.988148
[2025-07-27T18:28:40.938+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 15:28:23.988148 to 2025-07-20 16:28:23.988148
[2025-07-27T18:28:41.146+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 16:28:23.988148 to 2025-07-21 17:28:23.988148
[2025-07-27T18:28:41.363+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 17:28:23.988148 to 2025-07-22 18:28:23.988148
[2025-07-27T18:28:41.785+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 18:28:23.988148 to 2025-07-23 19:28:23.988148
[2025-07-27T18:28:42.306+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 19:28:23.988148 to 2025-07-24 20:28:23.988148
[2025-07-27T18:28:42.514+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 20:28:23.988148 to 2025-07-25 21:28:23.988148
[2025-07-27T18:28:42.084+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 21:28:23.988148 to 2025-07-26 22:28:23.988148
[2025-07-27T18:28:42.521+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 22:28:23.988148 to 2025-07-27 18:28:23.988148
[2025-07-27T18:28:42.669+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727182842.csv
[2025-07-27T18:28:42.908+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 18:28:23.988148 to 2025-06-28 19:28:23.988148
[2025-07-27T18:28:43.120+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 19:28:23.988148 to 2025-06-29 20:28:23.988148
[2025-07-27T18:28:43.322+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 20:28:23.988148 to 2025-06-30 21:28:23.988148
[2025-07-27T18:28:43.840+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 21:28:23.988148 to 2025-07-01 22:28:23.988148
[2025-07-27T18:28:44.792+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 22:28:23.988148 to 2025-07-02 23:28:23.988148
[2025-07-27T18:28:45.907+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 23:28:23.988148 to 2025-07-04 00:28:23.988148
[2025-07-27T18:28:46.149+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 00:28:23.988148 to 2025-07-05 01:28:23.988148
[2025-07-27T18:28:46.341+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 01:28:23.988148 to 2025-07-06 02:28:23.988148
[2025-07-27T18:28:46.558+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 02:28:23.988148 to 2025-07-07 03:28:23.988148
[2025-07-27T18:28:46.735+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 03:28:23.988148 to 2025-07-08 04:28:23.988148
[2025-07-27T18:28:47.211+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 04:28:23.988148 to 2025-07-09 05:28:23.988148
[2025-07-27T18:28:47.424+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 05:28:23.988148 to 2025-07-10 06:28:23.988148
[2025-07-27T18:28:48.184+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 06:28:23.988148 to 2025-07-11 07:28:23.988148
[2025-07-27T18:28:48.394+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 07:28:23.988148 to 2025-07-12 08:28:23.988148
[2025-07-27T18:28:48.599+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 08:28:23.988148 to 2025-07-13 09:28:23.988148
[2025-07-27T18:28:50.697+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 09:28:23.988148 to 2025-07-14 10:28:23.988148
[2025-07-27T18:28:50.918+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 10:28:23.988148 to 2025-07-15 11:28:23.988148
[2025-07-27T18:28:51.160+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 11:28:23.988148 to 2025-07-16 12:28:23.988148
[2025-07-27T18:28:51.334+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 12:28:23.988148 to 2025-07-17 13:28:23.988148
[2025-07-27T18:28:51.557+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 13:28:23.988148 to 2025-07-18 14:28:23.988148
[2025-07-27T18:28:52.784+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 14:28:23.988148 to 2025-07-19 15:28:23.988148
[2025-07-27T18:28:53.000+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 15:28:23.988148 to 2025-07-20 16:28:23.988148
[2025-07-27T18:28:53.173+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 16:28:23.988148 to 2025-07-21 17:28:23.988148
[2025-07-27T18:28:53.381+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 17:28:23.988148 to 2025-07-22 18:28:23.988148
[2025-07-27T18:28:54.078+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 18:28:23.988148 to 2025-07-23 19:28:23.988148
[2025-07-27T18:28:54.285+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 19:28:23.988148 to 2025-07-24 20:28:23.988148
[2025-07-27T18:28:54.626+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 20:28:23.988148 to 2025-07-25 21:28:23.988148
[2025-07-27T18:28:54.854+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 21:28:23.988148 to 2025-07-26 22:28:23.988148
[2025-07-27T18:28:56.998+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 22:28:23.988148 to 2025-07-27 18:28:23.988148
[2025-07-27T18:28:57.118+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727182857.csv
[2025-07-27T18:28:57.119+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T18:28:57.120+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:28:57.172+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727182641.csv
[2025-07-27T18:28:57.208+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727182842.csv
[2025-07-27T18:28:57.223+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T18:28:57.224+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T18:28:57.225+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:28:57.388+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T18:28:57.389+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T18:28:57.390+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T18:28:57.427+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T18:28:57.429+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:28:57.432+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:28:57.434+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8590, 80)
[2025-07-27T18:28:57.448+0000] {ingestion_inference.py:101} ERROR - Erreur lors du scaling: "['timestamp', 'symbol'] not found in axis"
[2025-07-27T18:28:57.450+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T18:28:57.451+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 97, in preprocess_and_upload
    X = df_features_scaled.drop(columns=exclude_cols)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 5581, in drop
    return super().drop(
           ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 4788, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 4830, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 7070, in drop
    raise KeyError(f"{labels[mask].tolist()} not found in axis")
KeyError: "['timestamp', 'symbol'] not found in axis"
[2025-07-27T18:28:57.484+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T170000, start_date=20250727T182823, end_date=20250727T182857
[2025-07-27T18:28:57.518+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload ("['timestamp', 'symbol'] not found in axis"; 596)
[2025-07-27T18:28:57.572+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T18:28:57.596+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T18:28:57.600+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T18:34:17.744+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T18:34:17.787+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:34:17.798+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [queued]>
[2025-07-27T18:34:17.798+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T18:34:17.822+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 17:00:00+00:00
[2025-07-27T18:34:17.842+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=601) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T18:34:17.839+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T17:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmp5og7fd3u']
[2025-07-27T18:34:17.844+0000] {standard_task_runner.py:63} INFO - Started process 622 to run task
[2025-07-27T18:34:17.844+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T18:34:17.890+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T18:34:17.947+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T17:00:00+00:00 [running]> on host ad22cb2f7f4c
[2025-07-27T18:34:18.123+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T17:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T17:00:00+00:00'
[2025-07-27T18:34:18.125+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T18:34:18.163+0000] {ingestion_inference.py:53} INFO - Bucket crypto-mlops-bucket exists
[2025-07-27T18:34:18.164+0000] {ingestion_inference.py:62} INFO - === Début du préprocessing ===
[2025-07-27T18:34:18.491+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 18:34:18.193555 to 2025-06-28 19:34:18.193555
[2025-07-27T18:34:18.680+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 19:34:18.193555 to 2025-06-29 20:34:18.193555
[2025-07-27T18:34:18.849+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 20:34:18.193555 to 2025-06-30 21:34:18.193555
[2025-07-27T18:34:19.050+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 21:34:18.193555 to 2025-07-01 22:34:18.193555
[2025-07-27T18:34:19.259+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 22:34:18.193555 to 2025-07-02 23:34:18.193555
[2025-07-27T18:34:19.463+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 23:34:18.193555 to 2025-07-04 00:34:18.193555
[2025-07-27T18:34:19.686+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 00:34:18.193555 to 2025-07-05 01:34:18.193555
[2025-07-27T18:34:19.894+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 01:34:18.193555 to 2025-07-06 02:34:18.193555
[2025-07-27T18:34:20.065+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 02:34:18.193555 to 2025-07-07 03:34:18.193555
[2025-07-27T18:34:20.272+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 03:34:18.193555 to 2025-07-08 04:34:18.193555
[2025-07-27T18:34:20.495+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 04:34:18.193555 to 2025-07-09 05:34:18.193555
[2025-07-27T18:34:20.930+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 05:34:18.193555 to 2025-07-10 06:34:18.193555
[2025-07-27T18:34:19.509+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 06:34:18.193555 to 2025-07-11 07:34:18.193555
[2025-07-27T18:34:19.704+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 07:34:18.193555 to 2025-07-12 08:34:18.193555
[2025-07-27T18:34:20.865+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 08:34:18.193555 to 2025-07-13 09:34:18.193555
[2025-07-27T18:34:21.079+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 09:34:18.193555 to 2025-07-14 10:34:18.193555
[2025-07-27T18:34:21.269+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 10:34:18.193555 to 2025-07-15 11:34:18.193555
[2025-07-27T18:34:21.450+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 11:34:18.193555 to 2025-07-16 12:34:18.193555
[2025-07-27T18:34:21.656+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 12:34:18.193555 to 2025-07-17 13:34:18.193555
[2025-07-27T18:34:21.835+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 13:34:18.193555 to 2025-07-18 14:34:18.193555
[2025-07-27T18:34:22.046+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 14:34:18.193555 to 2025-07-19 15:34:18.193555
[2025-07-27T18:34:22.225+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 15:34:18.193555 to 2025-07-20 16:34:18.193555
[2025-07-27T18:34:22.680+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 16:34:18.193555 to 2025-07-21 17:34:18.193555
[2025-07-27T18:34:26.640+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 17:34:18.193555 to 2025-07-22 18:34:18.193555
[2025-07-27T18:34:26.893+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 18:34:18.193555 to 2025-07-23 19:34:18.193555
[2025-07-27T18:34:27.319+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 19:34:18.193555 to 2025-07-24 20:34:18.193555
[2025-07-27T18:34:27.837+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 20:34:18.193555 to 2025-07-25 21:34:18.193555
[2025-07-27T18:34:28.016+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 21:34:18.193555 to 2025-07-26 22:34:18.193555
[2025-07-27T18:34:28.439+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 22:34:18.193555 to 2025-07-27 18:34:18.193555
[2025-07-27T18:34:28.598+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727183428.csv
[2025-07-27T18:34:29.565+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 18:34:18.193555 to 2025-06-28 19:34:18.193555
[2025-07-27T18:34:29.783+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 19:34:18.193555 to 2025-06-29 20:34:18.193555
[2025-07-27T18:34:29.996+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 20:34:18.193555 to 2025-06-30 21:34:18.193555
[2025-07-27T18:34:30.572+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 21:34:18.193555 to 2025-07-01 22:34:18.193555
[2025-07-27T18:34:30.789+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 22:34:18.193555 to 2025-07-02 23:34:18.193555
[2025-07-27T18:34:31.001+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 23:34:18.193555 to 2025-07-04 00:34:18.193555
[2025-07-27T18:34:31.219+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 00:34:18.193555 to 2025-07-05 01:34:18.193555
[2025-07-27T18:34:31.404+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 01:34:18.193555 to 2025-07-06 02:34:18.193555
[2025-07-27T18:34:31.636+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 02:34:18.193555 to 2025-07-07 03:34:18.193555
[2025-07-27T18:34:32.057+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 03:34:18.193555 to 2025-07-08 04:34:18.193555
[2025-07-27T18:34:32.250+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 04:34:18.193555 to 2025-07-09 05:34:18.193555
[2025-07-27T18:34:33.291+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 05:34:18.193555 to 2025-07-10 06:34:18.193555
[2025-07-27T18:34:33.621+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 06:34:18.193555 to 2025-07-11 07:34:18.193555
[2025-07-27T18:34:33.878+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 07:34:18.193555 to 2025-07-12 08:34:18.193555
[2025-07-27T18:34:34.267+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 08:34:18.193555 to 2025-07-13 09:34:18.193555
[2025-07-27T18:34:34.811+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 09:34:18.193555 to 2025-07-14 10:34:18.193555
[2025-07-27T18:34:35.031+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 10:34:18.193555 to 2025-07-15 11:34:18.193555
[2025-07-27T18:34:37.204+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 11:34:18.193555 to 2025-07-16 12:34:18.193555
[2025-07-27T18:34:39.356+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 12:34:18.193555 to 2025-07-17 13:34:18.193555
[2025-07-27T18:34:39.568+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 13:34:18.193555 to 2025-07-18 14:34:18.193555
[2025-07-27T18:34:39.781+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 14:34:18.193555 to 2025-07-19 15:34:18.193555
[2025-07-27T18:34:39.989+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 15:34:18.193555 to 2025-07-20 16:34:18.193555
[2025-07-27T18:34:40.167+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 16:34:18.193555 to 2025-07-21 17:34:18.193555
[2025-07-27T18:34:40.345+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 17:34:18.193555 to 2025-07-22 18:34:18.193555
[2025-07-27T18:34:40.562+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 18:34:18.193555 to 2025-07-23 19:34:18.193555
[2025-07-27T18:34:40.753+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 19:34:18.193555 to 2025-07-24 20:34:18.193555
[2025-07-27T18:34:40.967+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 20:34:18.193555 to 2025-07-25 21:34:18.193555
[2025-07-27T18:34:41.196+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 21:34:18.193555 to 2025-07-26 22:34:18.193555
[2025-07-27T18:34:41.391+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 22:34:18.193555 to 2025-07-27 18:34:18.193555
[2025-07-27T18:34:41.474+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727183441.csv
[2025-07-27T18:34:41.475+0000] {ingestion_inference.py:67} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-27T18:34:41.476+0000] {ingestion_inference.py:68} INFO - Colonnes brutes : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:34:41.517+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250727183245.csv
[2025-07-27T18:34:41.545+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250727183428.csv
[2025-07-27T18:34:41.552+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-27T18:34:41.553+0000] {ingestion_inference.py:73} INFO - Données combinées après combine_datasets : shape=(8640, 7)
[2025-07-27T18:34:41.554+0000] {ingestion_inference.py:74} INFO - Colonnes combinées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol']
[2025-07-27T18:34:41.704+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-27T18:34:41.706+0000] {ingestion_inference.py:77} INFO - Données après feature engineering : shape=(8590, 84)
[2025-07-27T18:34:41.707+0000] {ingestion_inference.py:78} INFO - Features générées : ['timestamp', 'low', 'high', 'open', 'close', 'volume', 'symbol', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month', 'target', 'target_change']
[2025-07-27T18:34:41.721+0000] {ingestion_inference.py:82} INFO - Scaler chargé : StandardScaler()
[2025-07-27T18:34:41.722+0000] {ingestion_inference.py:84} INFO - Features attendues par le scaler (processor.features) : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:34:41.725+0000] {ingestion_inference.py:90} INFO - Features sélectionnées pour scaler : ['low', 'high', 'open', 'close', 'volume', 'price_change', 'volume_change', 'high_low_ratio', 'close_open_ratio', 'price_range', 'sma_5', 'ema_5', 'volume_sma_5', 'price_vs_sma_5', 'price_vs_ema_5', 'sma_10', 'ema_10', 'volume_sma_10', 'price_vs_sma_10', 'price_vs_ema_10', 'sma_20', 'ema_20', 'volume_sma_20', 'price_vs_sma_20', 'price_vs_ema_20', 'sma_50', 'ema_50', 'volume_sma_50', 'price_vs_sma_50', 'price_vs_ema_50', 'macd', 'macd_signal', 'rsi', 'bbands_upper', 'bbands_lower', 'bbands_position', 'atr', 'volume_sma_ratio', 'close_lag_1', 'volume_lag_1', 'rsi_lag_1', 'price_change_lag_1', 'close_lag_2', 'volume_lag_2', 'rsi_lag_2', 'price_change_lag_2', 'close_lag_3', 'volume_lag_3', 'rsi_lag_3', 'price_change_lag_3', 'close_lag_5', 'volume_lag_5', 'rsi_lag_5', 'price_change_lag_5', 'close_lag_10', 'volume_lag_10', 'rsi_lag_10', 'price_change_lag_10', 'close_std_5', 'volume_std_5', 'price_change_std_5', 'close_min_5', 'close_max_5', 'close_position_5', 'close_std_10', 'volume_std_10', 'price_change_std_10', 'close_min_10', 'close_max_10', 'close_position_10', 'close_std_20', 'volume_std_20', 'price_change_std_20', 'close_min_20', 'close_max_20', 'close_position_20', 'hour', 'day_of_week', 'day_of_month', 'month']
[2025-07-27T18:34:41.726+0000] {ingestion_inference.py:91} INFO - Shape des données avant scaling : (8590, 80)
[2025-07-27T18:34:41.740+0000] {ingestion_inference.py:96} INFO - Shape des données après scaling : (8590, 80)
[2025-07-27T18:34:41.743+0000] {ingestion_inference.py:104} INFO - Extraction dernière ligne timestamp 8589 pour export : shape=(1, 80)
[2025-07-27T18:34:41.802+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-27T18:34:41.817+0000] {ingestion_inference.py:118} INFO - Uploaded features to s3://crypto-mlops-bucket/features/date=2025-07-27/hour=17/features.parquet
[2025-07-27T18:34:41.818+0000] {ingestion_inference.py:120} INFO - === Fin du préprocessing ===
[2025-07-27T18:34:41.820+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-27T18:34:41.821+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T18:34:41.833+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T170000, start_date=20250727T183417, end_date=20250727T183441
[2025-07-27T18:34:41.911+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-27T18:34:41.939+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T18:34:41.942+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
