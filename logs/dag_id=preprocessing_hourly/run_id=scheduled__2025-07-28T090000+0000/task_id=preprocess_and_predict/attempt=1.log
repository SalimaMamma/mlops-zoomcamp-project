[2025-07-28T10:03:39.769+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-28T10:03:39.812+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [queued]>
[2025-07-28T10:03:39.822+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [queued]>
[2025-07-28T10:03:39.825+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-28T10:03:39.843+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_predict> on 2025-07-28 09:00:00+00:00
[2025-07-28T10:03:39.861+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=2416) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-28T10:03:39.860+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_predict', 'scheduled__2025-07-28T09:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpzozeypm4']
[2025-07-28T10:03:39.862+0000] {standard_task_runner.py:63} INFO - Started process 2434 to run task
[2025-07-28T10:03:39.863+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_predict
[2025-07-28T10:03:39.880+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-28T10:03:39.922+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [running]> on host d78ad09e75e4
[2025-07-28T10:03:40.014+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-07-28T09:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-28T09:00:00+00:00'
[2025-07-28T10:03:40.016+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-28T10:03:40.030+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-28T10:03:40.031+0000] {ingestion_inference.py:67} INFO - [DEBUG] Execution date: 2025-07-28 09:00:00+00:00 (type=<class 'Proxy'>)
[2025-07-28T10:03:40.046+0000] {ingestion_inference.py:56} INFO - Bucket crypto-mlops-bucket exists
[2025-07-28T10:03:40.047+0000] {ingestion_inference.py:74} INFO - === Début du préprocessing ===
[2025-07-28T10:03:40.276+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 10:03:40.056332 to 2025-06-29 11:03:40.056332
[2025-07-28T10:03:40.455+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 11:03:40.056332 to 2025-06-30 12:03:40.056332
[2025-07-28T10:03:40.892+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 12:03:40.056332 to 2025-07-01 13:03:40.056332
[2025-07-28T10:03:41.088+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 13:03:40.056332 to 2025-07-02 14:03:40.056332
[2025-07-28T10:03:41.308+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 14:03:40.056332 to 2025-07-03 15:03:40.056332
[2025-07-28T10:03:41.477+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 15:03:40.056332 to 2025-07-04 16:03:40.056332
[2025-07-28T10:03:41.672+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 16:03:40.056332 to 2025-07-05 17:03:40.056332
[2025-07-28T10:03:42.154+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 17:03:40.056332 to 2025-07-06 18:03:40.056332
[2025-07-28T10:03:42.369+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 18:03:40.056332 to 2025-07-07 19:03:40.056332
[2025-07-28T10:03:42.580+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 19:03:40.056332 to 2025-07-08 20:03:40.056332
[2025-07-28T10:03:42.787+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 20:03:40.056332 to 2025-07-09 21:03:40.056332
[2025-07-28T10:03:42.953+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 21:03:40.056332 to 2025-07-10 22:03:40.056332
[2025-07-28T10:03:43.146+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 22:03:40.056332 to 2025-07-11 23:03:40.056332
[2025-07-28T10:03:43.653+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 23:03:40.056332 to 2025-07-13 00:03:40.056332
[2025-07-28T10:03:44.081+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 00:03:40.056332 to 2025-07-14 01:03:40.056332
[2025-07-28T10:03:44.271+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 01:03:40.056332 to 2025-07-15 02:03:40.056332
[2025-07-28T10:03:44.470+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 02:03:40.056332 to 2025-07-16 03:03:40.056332
[2025-07-28T10:03:44.672+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 03:03:40.056332 to 2025-07-17 04:03:40.056332
[2025-07-28T10:03:44.888+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 04:03:40.056332 to 2025-07-18 05:03:40.056332
[2025-07-28T10:03:45.099+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 05:03:40.056332 to 2025-07-19 06:03:40.056332
[2025-07-28T10:03:45.314+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 06:03:40.056332 to 2025-07-20 07:03:40.056332
[2025-07-28T10:03:45.756+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 07:03:40.056332 to 2025-07-21 08:03:40.056332
[2025-07-28T10:03:45.979+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 08:03:40.056332 to 2025-07-22 09:03:40.056332
[2025-07-28T10:03:46.180+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 09:03:40.056332 to 2025-07-23 10:03:40.056332
[2025-07-28T10:03:46.384+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 10:03:40.056332 to 2025-07-24 11:03:40.056332
[2025-07-28T10:03:46.549+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 11:03:40.056332 to 2025-07-25 12:03:40.056332
[2025-07-28T10:03:46.746+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 12:03:40.056332 to 2025-07-26 13:03:40.056332
[2025-07-28T10:03:46.902+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-26 13:03:40.056332 to 2025-07-27 14:03:40.056332
[2025-07-28T10:03:47.102+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-27 14:03:40.056332 to 2025-07-28 10:03:40.056332
[2025-07-28T10:03:47.203+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250728100347.csv
[2025-07-28T10:03:46.178+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 10:03:40.056332 to 2025-06-29 11:03:40.056332
[2025-07-28T10:03:46.370+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 11:03:40.056332 to 2025-06-30 12:03:40.056332
[2025-07-28T10:03:46.577+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 12:03:40.056332 to 2025-07-01 13:03:40.056332
[2025-07-28T10:03:46.759+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 13:03:40.056332 to 2025-07-02 14:03:40.056332
[2025-07-28T10:03:47.212+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 14:03:40.056332 to 2025-07-03 15:03:40.056332
[2025-07-28T10:03:47.429+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 15:03:40.056332 to 2025-07-04 16:03:40.056332
[2025-07-28T10:03:47.636+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 16:03:40.056332 to 2025-07-05 17:03:40.056332
[2025-07-28T10:03:48.130+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 17:03:40.056332 to 2025-07-06 18:03:40.056332
[2025-07-28T10:03:48.557+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 18:03:40.056332 to 2025-07-07 19:03:40.056332
[2025-07-28T10:03:48.766+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 19:03:40.056332 to 2025-07-08 20:03:40.056332
[2025-07-28T10:03:49.242+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 20:03:40.056332 to 2025-07-09 21:03:40.056332
[2025-07-28T10:03:49.751+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 21:03:40.056332 to 2025-07-10 22:03:40.056332
[2025-07-28T10:03:49.952+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 22:03:40.056332 to 2025-07-11 23:03:40.056332
[2025-07-28T10:03:50.360+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 23:03:40.056332 to 2025-07-13 00:03:40.056332
[2025-07-28T10:03:50.588+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 00:03:40.056332 to 2025-07-14 01:03:40.056332
[2025-07-28T10:03:51.017+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 01:03:40.056332 to 2025-07-15 02:03:40.056332
[2025-07-28T10:03:51.215+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 02:03:40.056332 to 2025-07-16 03:03:40.056332
[2025-07-28T10:03:51.626+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 03:03:40.056332 to 2025-07-17 04:03:40.056332
[2025-07-28T10:03:51.797+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 04:03:40.056332 to 2025-07-18 05:03:40.056332
[2025-07-28T10:03:52.256+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 05:03:40.056332 to 2025-07-19 06:03:40.056332
[2025-07-28T10:03:52.459+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 06:03:40.056332 to 2025-07-20 07:03:40.056332
[2025-07-28T10:03:52.694+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 07:03:40.056332 to 2025-07-21 08:03:40.056332
[2025-07-28T10:03:52.912+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 08:03:40.056332 to 2025-07-22 09:03:40.056332
[2025-07-28T10:03:53.075+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 09:03:40.056332 to 2025-07-23 10:03:40.056332
[2025-07-28T10:03:53.269+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 10:03:40.056332 to 2025-07-24 11:03:40.056332
[2025-07-28T10:03:53.467+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 11:03:40.056332 to 2025-07-25 12:03:40.056332
[2025-07-28T10:03:53.649+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 12:03:40.056332 to 2025-07-26 13:03:40.056332
[2025-07-28T10:03:53.846+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-26 13:03:40.056332 to 2025-07-27 14:03:40.056332
[2025-07-28T10:03:54.255+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-27 14:03:40.056332 to 2025-07-28 10:03:40.056332
[2025-07-28T10:03:54.331+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250728100354.csv
[2025-07-28T10:03:54.331+0000] {ingestion_inference.py:79} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-28T10:03:54.725+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250728095804.csv
[2025-07-28T10:03:54.746+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250728100347.csv
[2025-07-28T10:03:54.754+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-28T10:03:54.755+0000] {ingestion_inference.py:83} INFO - Données combinées : shape=(8640, 7)
[2025-07-28T10:03:54.863+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-28T10:03:54.865+0000] {ingestion_inference.py:86} INFO - Features : shape=(8590, 84)
[2025-07-28T10:03:54.875+0000] {ingestion_inference.py:90} INFO - Scaler chargé
[2025-07-28T10:03:54.888+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-28T10:03:54.896+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-28T10:03:54.897+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-28T10:03:54.909+0000] {ingestion_inference.py:100} INFO - Last row : shape=(1, 81)
[2025-07-28T10:03:54.981+0000] {ingestion_inference.py:110} INFO - ✅ Features uploaded → s3://crypto-mlops-bucket/features/date=2025-07-28/hour=09/features.parquet
[2025-07-28T10:03:54.992+0000] {ingestion_inference.py:121} INFO - ✅ Target uploaded → s3://crypto-mlops-bucket/targets/date=2025-07-28/hour=09/target.parquet
[2025-07-28T10:03:55.116+0000] {credentials.py:1147} INFO - Found credentials in environment variables.
[2025-07-28T10:03:55.230+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:   0%|          | 0/5 [00:00<?, ?it/s]
[2025-07-28T10:03:55.256+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  20%|##        | 1/5 [00:00<00:00, 41.23it/s]
[2025-07-28T10:03:55.259+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  40%|####      | 2/5 [00:00<00:00, 71.51it/s]
[2025-07-28T10:03:55.263+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  60%|######    | 3/5 [00:00<00:00, 94.32it/s]
[2025-07-28T10:03:55.273+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  80%|########  | 4/5 [00:00<00:00, 94.97it/s]
[2025-07-28T10:03:55.275+0000] {logging_mixin.py:188} WARNING - Downloading artifacts: 100%|##########| 5/5 [00:00<00:00, 114.17it/s]
[2025-07-28T10:03:55.276+0000] {logging_mixin.py:188} WARNING - Downloading artifacts: 100%|##########| 5/5 [00:00<00:00, 111.71it/s]
[2025-07-28T10:03:55.476+0000] {ingestion_inference.py:134} INFO - ✅ Model loaded: crypto_lightgbm_model_BTC_USD, version 1
[2025-07-28T10:03:55.493+0000] {ingestion_inference.py:154} INFO - ✅ Prediction uploaded → s3://crypto-mlops-bucket/predictions/date=2025-07-28/hour=09/prediction.parquet
[2025-07-28T10:03:55.493+0000] {ingestion_inference.py:156} INFO - === Fin du préprocessing & prédiction ===
[2025-07-28T10:03:55.495+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-28T10:03:55.496+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-28T10:03:55.507+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_predict, execution_date=20250728T090000, start_date=20250728T100339, end_date=20250728T100355
[2025-07-28T10:03:55.579+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-28T10:03:55.598+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-28T10:03:55.600+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-28T10:18:03.145+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-28T10:18:03.187+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [queued]>
[2025-07-28T10:18:03.195+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [queued]>
[2025-07-28T10:18:03.196+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-28T10:18:03.209+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_predict> on 2025-07-28 09:00:00+00:00
[2025-07-28T10:18:03.226+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=1330) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-28T10:18:03.226+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_predict', 'scheduled__2025-07-28T09:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpomf8dun_']
[2025-07-28T10:18:03.228+0000] {standard_task_runner.py:63} INFO - Started process 1348 to run task
[2025-07-28T10:18:03.228+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_predict
[2025-07-28T10:18:03.243+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-28T10:18:03.284+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_predict scheduled__2025-07-28T09:00:00+00:00 [running]> on host d78ad09e75e4
[2025-07-28T10:18:03.368+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-07-28T09:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-28T09:00:00+00:00'
[2025-07-28T10:18:03.370+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-28T10:18:03.382+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/utils/context.py:320 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-07-28T10:18:03.382+0000] {ingestion_inference.py:67} INFO - [DEBUG] Execution date: 2025-07-28 09:00:00+00:00 (type=<class 'Proxy'>)
[2025-07-28T10:18:03.397+0000] {ingestion_inference.py:56} INFO - Bucket crypto-mlops-bucket exists
[2025-07-28T10:18:03.398+0000] {ingestion_inference.py:74} INFO - === Début du préprocessing ===
[2025-07-28T10:18:03.632+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 10:18:03.408135 to 2025-06-29 11:18:03.408135
[2025-07-28T10:18:04.124+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 11:18:03.408135 to 2025-06-30 12:18:03.408135
[2025-07-28T10:18:04.336+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 12:18:03.408135 to 2025-07-01 13:18:03.408135
[2025-07-28T10:18:04.801+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 13:18:03.408135 to 2025-07-02 14:18:03.408135
[2025-07-28T10:18:05.006+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 14:18:03.408135 to 2025-07-03 15:18:03.408135
[2025-07-28T10:18:05.483+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 15:18:03.408135 to 2025-07-04 16:18:03.408135
[2025-07-28T10:18:05.909+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 16:18:03.408135 to 2025-07-05 17:18:03.408135
[2025-07-28T10:18:06.329+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 17:18:03.408135 to 2025-07-06 18:18:03.408135
[2025-07-28T10:18:06.548+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 18:18:03.408135 to 2025-07-07 19:18:03.408135
[2025-07-28T10:18:06.962+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 19:18:03.408135 to 2025-07-08 20:18:03.408135
[2025-07-28T10:18:07.221+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-08 20:18:03.408135 to 2025-07-09 21:18:03.408135
[2025-07-28T10:18:07.432+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 21:18:03.408135 to 2025-07-10 22:18:03.408135
[2025-07-28T10:18:07.613+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 22:18:03.408135 to 2025-07-11 23:18:03.408135
[2025-07-28T10:18:07.811+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 23:18:03.408135 to 2025-07-13 00:18:03.408135
[2025-07-28T10:18:08.229+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 00:18:03.408135 to 2025-07-14 01:18:03.408135
[2025-07-28T10:18:08.433+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 01:18:03.408135 to 2025-07-15 02:18:03.408135
[2025-07-28T10:18:08.856+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 02:18:03.408135 to 2025-07-16 03:18:03.408135
[2025-07-28T10:18:09.067+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 03:18:03.408135 to 2025-07-17 04:18:03.408135
[2025-07-28T10:18:09.278+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 04:18:03.408135 to 2025-07-18 05:18:03.408135
[2025-07-28T10:18:09.475+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 05:18:03.408135 to 2025-07-19 06:18:03.408135
[2025-07-28T10:18:09.668+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 06:18:03.408135 to 2025-07-20 07:18:03.408135
[2025-07-28T10:18:09.855+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 07:18:03.408135 to 2025-07-21 08:18:03.408135
[2025-07-28T10:18:10.073+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 08:18:03.408135 to 2025-07-22 09:18:03.408135
[2025-07-28T10:18:10.281+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 09:18:03.408135 to 2025-07-23 10:18:03.408135
[2025-07-28T10:18:10.788+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 10:18:03.408135 to 2025-07-24 11:18:03.408135
[2025-07-28T10:18:10.983+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 11:18:03.408135 to 2025-07-25 12:18:03.408135
[2025-07-28T10:18:11.185+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 12:18:03.408135 to 2025-07-26 13:18:03.408135
[2025-07-28T10:18:11.376+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-26 13:18:03.408135 to 2025-07-27 14:18:03.408135
[2025-07-28T10:18:11.573+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-27 14:18:03.408135 to 2025-07-28 10:18:03.408135
[2025-07-28T10:18:11.677+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250728101811.csv
[2025-07-28T10:18:12.093+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 10:18:03.408135 to 2025-06-29 11:18:03.408135
[2025-07-28T10:18:12.297+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 11:18:03.408135 to 2025-06-30 12:18:03.408135
[2025-07-28T10:18:12.507+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 12:18:03.408135 to 2025-07-01 13:18:03.408135
[2025-07-28T10:18:12.677+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 13:18:03.408135 to 2025-07-02 14:18:03.408135
[2025-07-28T10:18:12.867+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 14:18:03.408135 to 2025-07-03 15:18:03.408135
[2025-07-28T10:18:13.066+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 15:18:03.408135 to 2025-07-04 16:18:03.408135
[2025-07-28T10:18:13.290+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 16:18:03.408135 to 2025-07-05 17:18:03.408135
[2025-07-28T10:18:13.494+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 17:18:03.408135 to 2025-07-06 18:18:03.408135
[2025-07-28T10:18:13.721+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 18:18:03.408135 to 2025-07-07 19:18:03.408135
[2025-07-28T10:18:13.926+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 19:18:03.408135 to 2025-07-08 20:18:03.408135
[2025-07-28T10:18:14.099+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-08 20:18:03.408135 to 2025-07-09 21:18:03.408135
[2025-07-28T10:18:14.288+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 21:18:03.408135 to 2025-07-10 22:18:03.408135
[2025-07-28T10:18:14.784+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 22:18:03.408135 to 2025-07-11 23:18:03.408135
[2025-07-28T10:18:15.223+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 23:18:03.408135 to 2025-07-13 00:18:03.408135
[2025-07-28T10:18:15.485+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 00:18:03.408135 to 2025-07-14 01:18:03.408135
[2025-07-28T10:18:15.704+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 01:18:03.408135 to 2025-07-15 02:18:03.408135
[2025-07-28T10:18:15.908+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 02:18:03.408135 to 2025-07-16 03:18:03.408135
[2025-07-28T10:18:16.107+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 03:18:03.408135 to 2025-07-17 04:18:03.408135
[2025-07-28T10:18:16.315+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 04:18:03.408135 to 2025-07-18 05:18:03.408135
[2025-07-28T10:18:16.798+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 05:18:03.408135 to 2025-07-19 06:18:03.408135
[2025-07-28T10:18:17.035+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 06:18:03.408135 to 2025-07-20 07:18:03.408135
[2025-07-28T10:18:17.278+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 07:18:03.408135 to 2025-07-21 08:18:03.408135
[2025-07-28T10:18:17.519+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 08:18:03.408135 to 2025-07-22 09:18:03.408135
[2025-07-28T10:18:18.030+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 09:18:03.408135 to 2025-07-23 10:18:03.408135
[2025-07-28T10:18:18.199+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 10:18:03.408135 to 2025-07-24 11:18:03.408135
[2025-07-28T10:18:18.399+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 11:18:03.408135 to 2025-07-25 12:18:03.408135
[2025-07-28T10:18:18.564+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 12:18:03.408135 to 2025-07-26 13:18:03.408135
[2025-07-28T10:18:18.765+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-26 13:18:03.408135 to 2025-07-27 14:18:03.408135
[2025-07-28T10:18:18.932+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-27 14:18:03.408135 to 2025-07-28 10:18:03.408135
[2025-07-28T10:18:19.006+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250728101818.csv
[2025-07-28T10:18:19.007+0000] {ingestion_inference.py:79} INFO - Données brutes récupérées : shape=(8640, 7)
[2025-07-28T10:18:19.045+0000] {data_processing.py:40} INFO - Loaded 288 records from S3: data/historical_BTC_USD_20250728101554.csv
[2025-07-28T10:18:19.072+0000] {data_processing.py:40} INFO - Loaded 8640 records from S3: data/historical_BTC_USD_20250728101811.csv
[2025-07-28T10:18:19.079+0000] {data_processing.py:84} INFO - Combined 8640 records for BTC-USD
[2025-07-28T10:18:19.080+0000] {ingestion_inference.py:83} INFO - Données combinées : shape=(8640, 7)
[2025-07-28T10:18:19.199+0000] {data_processing.py:162} INFO - Removed 50 rows with NaN values. Final shape: (8590, 84)
[2025-07-28T10:18:19.201+0000] {ingestion_inference.py:86} INFO - Features : shape=(8590, 84)
[2025-07-28T10:18:19.214+0000] {ingestion_inference.py:90} INFO - Scaler chargé
[2025-07-28T10:18:19.225+0000] {logging_mixin.py:188} WARNING - /opt/***/src/data_processing.py:177 FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
[2025-07-28T10:18:19.238+0000] {data_processing.py:179} INFO - Prepared features: (8590, 80), Target: (8590,)
[2025-07-28T10:18:19.239+0000] {data_processing.py:180} INFO - Feature columns: 80
[2025-07-28T10:18:19.254+0000] {ingestion_inference.py:100} INFO - Last row : shape=(1, 81)
[2025-07-28T10:18:19.321+0000] {ingestion_inference.py:110} INFO - ✅ Features uploaded → s3://crypto-mlops-bucket/features/date=2025-07-28/hour=09/features.parquet
[2025-07-28T10:18:19.333+0000] {ingestion_inference.py:121} INFO - ✅ Target uploaded → s3://crypto-mlops-bucket/targets/date=2025-07-28/hour=09/target.parquet
[2025-07-28T10:18:19.466+0000] {credentials.py:1147} INFO - Found credentials in environment variables.
[2025-07-28T10:18:19.586+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:   0%|          | 0/5 [00:00<?, ?it/s]
[2025-07-28T10:18:19.591+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  20%|##        | 1/5 [00:00<00:00, 477.93it/s]
[2025-07-28T10:18:19.615+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  40%|####      | 2/5 [00:00<00:00, 75.05it/s] 
[2025-07-28T10:18:19.621+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  60%|######    | 3/5 [00:00<00:00, 93.16it/s]
[2025-07-28T10:18:19.622+0000] {logging_mixin.py:188} WARNING - Downloading artifacts:  80%|########  | 4/5 [00:00<00:00, 117.69it/s]
[2025-07-28T10:18:19.623+0000] {logging_mixin.py:188} WARNING - Downloading artifacts: 100%|##########| 5/5 [00:00<00:00, 142.77it/s]
[2025-07-28T10:18:19.624+0000] {logging_mixin.py:188} WARNING - Downloading artifacts: 100%|##########| 5/5 [00:00<00:00, 139.53it/s]
[2025-07-28T10:18:19.842+0000] {ingestion_inference.py:134} INFO - ✅ Model loaded: crypto_lightgbm_model_BTC_USD, version 2
[2025-07-28T10:18:19.862+0000] {ingestion_inference.py:154} INFO - ✅ Prediction uploaded → s3://crypto-mlops-bucket/predictions/date=2025-07-28/hour=09/prediction.parquet
[2025-07-28T10:18:19.862+0000] {ingestion_inference.py:156} INFO - === Fin du préprocessing & prédiction ===
[2025-07-28T10:18:19.868+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-28T10:18:19.869+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-28T10:18:19.883+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=preprocessing_hourly, task_id=preprocess_and_predict, execution_date=20250728T090000, start_date=20250728T101803, end_date=20250728T101819
[2025-07-28T10:18:19.938+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-28T10:18:19.958+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-28T10:18:19.962+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
