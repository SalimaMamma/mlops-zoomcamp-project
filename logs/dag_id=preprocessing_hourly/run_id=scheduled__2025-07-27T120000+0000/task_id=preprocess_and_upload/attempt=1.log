[2025-07-27T13:38:49.532+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T13:38:49.610+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:38:49.630+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:38:49.632+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T13:38:49.939+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 12:00:00+00:00
[2025-07-27T13:38:50.021+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=558) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T13:38:50.038+0000] {standard_task_runner.py:63} INFO - Started process 579 to run task
[2025-07-27T13:38:50.015+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T12:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpz8cvoe_r']
[2025-07-27T13:38:50.041+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T13:38:50.199+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T13:38:50.448+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [running]> on host 80d66d5086f4
[2025-07-27T13:38:50.708+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T12:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T12:00:00+00:00'
[2025-07-27T13:38:50.711+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T13:38:50.843+0000] {ingestion_inference.py:51} INFO - Bucket crypto-preprocessed created
[2025-07-27T13:38:50.844+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T13:38:50.845+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 58, in preprocess_and_upload
    client = CoinbaseDataClient()
             ^^^^^^^^^^^^^^^^^^^^
TypeError: CoinbaseDataClient.__init__() missing 1 required positional argument: 'config'
[2025-07-27T13:38:50.885+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T120000, start_date=20250727T133849, end_date=20250727T133850
[2025-07-27T13:38:50.917+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload (CoinbaseDataClient.__init__() missing 1 required positional argument: 'config'; 579)
[2025-07-27T13:38:50.949+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T13:38:50.974+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T13:38:50.977+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T13:46:46.381+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T13:46:46.419+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:46:46.430+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:46:46.432+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T13:46:46.477+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 12:00:00+00:00
[2025-07-27T13:46:46.492+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T12:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmp5nxufei6']
[2025-07-27T13:46:46.495+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=358) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T13:46:46.496+0000] {standard_task_runner.py:91} INFO - Job 2: Subtask preprocess_and_upload
[2025-07-27T13:46:46.497+0000] {standard_task_runner.py:63} INFO - Started process 375 to run task
[2025-07-27T13:46:46.521+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T13:46:46.568+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [running]> on host 80d66d5086f4
[2025-07-27T13:46:46.731+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T12:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T12:00:00+00:00'
[2025-07-27T13:46:46.733+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T13:46:46.797+0000] {ingestion_inference.py:55} INFO - Bucket crypto-preprocessed created
[2025-07-27T13:46:47.032+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 13:46:46.814142 to 2025-06-28 14:46:46.814142
[2025-07-27T13:46:47.235+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 14:46:46.814142 to 2025-06-29 15:46:46.814142
[2025-07-27T13:46:47.425+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 15:46:46.814142 to 2025-06-30 16:46:46.814142
[2025-07-27T13:46:47.833+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 16:46:46.814142 to 2025-07-01 17:46:46.814142
[2025-07-27T13:46:48.034+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 17:46:46.814142 to 2025-07-02 18:46:46.814142
[2025-07-27T13:46:48.252+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 18:46:46.814142 to 2025-07-03 19:46:46.814142
[2025-07-27T13:46:48.472+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 19:46:46.814142 to 2025-07-04 20:46:46.814142
[2025-07-27T13:46:48.684+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 20:46:46.814142 to 2025-07-05 21:46:46.814142
[2025-07-27T13:46:49.029+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 21:46:46.814142 to 2025-07-06 22:46:46.814142
[2025-07-27T13:46:49.995+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 22:46:46.814142 to 2025-07-07 23:46:46.814142
[2025-07-27T13:46:50.199+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 23:46:46.814142 to 2025-07-09 00:46:46.814142
[2025-07-27T13:46:50.376+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 00:46:46.814142 to 2025-07-10 01:46:46.814142
[2025-07-27T13:46:50.584+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 01:46:46.814142 to 2025-07-11 02:46:46.814142
[2025-07-27T13:46:50.762+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 02:46:46.814142 to 2025-07-12 03:46:46.814142
[2025-07-27T13:46:51.314+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 03:46:46.814142 to 2025-07-13 04:46:46.814142
[2025-07-27T13:46:51.613+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 04:46:46.814142 to 2025-07-14 05:46:46.814142
[2025-07-27T13:46:51.813+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 05:46:46.814142 to 2025-07-15 06:46:46.814142
[2025-07-27T13:46:52.015+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 06:46:46.814142 to 2025-07-16 07:46:46.814142
[2025-07-27T13:46:52.256+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 07:46:46.814142 to 2025-07-17 08:46:46.814142
[2025-07-27T13:46:52.463+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 08:46:46.814142 to 2025-07-18 09:46:46.814142
[2025-07-27T13:46:52.696+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 09:46:46.814142 to 2025-07-19 10:46:46.814142
[2025-07-27T13:46:52.956+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 10:46:46.814142 to 2025-07-20 11:46:46.814142
[2025-07-27T13:46:53.204+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 11:46:46.814142 to 2025-07-21 12:46:46.814142
[2025-07-27T13:46:53.398+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 12:46:46.814142 to 2025-07-22 13:46:46.814142
[2025-07-27T13:46:53.616+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 13:46:46.814142 to 2025-07-23 14:46:46.814142
[2025-07-27T13:46:53.825+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 14:46:46.814142 to 2025-07-24 15:46:46.814142
[2025-07-27T13:46:54.016+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 15:46:46.814142 to 2025-07-25 16:46:46.814142
[2025-07-27T13:46:54.325+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 16:46:46.814142 to 2025-07-26 17:46:46.814142
[2025-07-27T13:46:54.530+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 17:46:46.814142 to 2025-07-27 13:46:46.814142
[2025-07-27T13:46:54.673+0000] {data_ingestion.py:106} ERROR - Error saving to S3: An error occurred (NoSuchBucket) when calling the PutObject operation: The specified bucket does not exist
[2025-07-27T13:46:54.899+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 13:46:46.814142 to 2025-06-28 14:46:46.814142
[2025-07-27T13:46:55.104+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 14:46:46.814142 to 2025-06-29 15:46:46.814142
[2025-07-27T13:46:55.310+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 15:46:46.814142 to 2025-06-30 16:46:46.814142
[2025-07-27T13:46:55.532+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 16:46:46.814142 to 2025-07-01 17:46:46.814142
[2025-07-27T13:46:55.929+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 17:46:46.814142 to 2025-07-02 18:46:46.814142
[2025-07-27T13:46:56.142+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 18:46:46.814142 to 2025-07-03 19:46:46.814142
[2025-07-27T13:46:56.324+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 19:46:46.814142 to 2025-07-04 20:46:46.814142
[2025-07-27T13:46:56.774+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 20:46:46.814142 to 2025-07-05 21:46:46.814142
[2025-07-27T13:46:57.195+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 21:46:46.814142 to 2025-07-06 22:46:46.814142
[2025-07-27T13:46:57.425+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 22:46:46.814142 to 2025-07-07 23:46:46.814142
[2025-07-27T13:46:57.614+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 23:46:46.814142 to 2025-07-09 00:46:46.814142
[2025-07-27T13:46:57.993+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 00:46:46.814142 to 2025-07-10 01:46:46.814142
[2025-07-27T13:46:58.545+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 01:46:46.814142 to 2025-07-11 02:46:46.814142
[2025-07-27T13:46:59.141+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 02:46:46.814142 to 2025-07-12 03:46:46.814142
[2025-07-27T13:46:59.313+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 03:46:46.814142 to 2025-07-13 04:46:46.814142
[2025-07-27T13:46:59.515+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 04:46:46.814142 to 2025-07-14 05:46:46.814142
[2025-07-27T13:46:59.973+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 05:46:46.814142 to 2025-07-15 06:46:46.814142
[2025-07-27T13:47:00.171+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 06:46:46.814142 to 2025-07-16 07:46:46.814142
[2025-07-27T13:47:00.398+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 07:46:46.814142 to 2025-07-17 08:46:46.814142
[2025-07-27T13:47:00.854+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 08:46:46.814142 to 2025-07-18 09:46:46.814142
[2025-07-27T13:47:01.040+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 09:46:46.814142 to 2025-07-19 10:46:46.814142
[2025-07-27T13:47:01.274+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 10:46:46.814142 to 2025-07-20 11:46:46.814142
[2025-07-27T13:47:01.475+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 11:46:46.814142 to 2025-07-21 12:46:46.814142
[2025-07-27T13:47:01.891+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 12:46:46.814142 to 2025-07-22 13:46:46.814142
[2025-07-27T13:47:02.381+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 13:46:46.814142 to 2025-07-23 14:46:46.814142
[2025-07-27T13:47:02.706+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 14:46:46.814142 to 2025-07-24 15:46:46.814142
[2025-07-27T13:47:02.913+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 15:46:46.814142 to 2025-07-25 16:46:46.814142
[2025-07-27T13:47:03.108+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 16:46:46.814142 to 2025-07-26 17:46:46.814142
[2025-07-27T13:47:03.326+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 17:46:46.814142 to 2025-07-27 13:46:46.814142
[2025-07-27T13:47:03.461+0000] {data_ingestion.py:106} ERROR - Error saving to S3: An error occurred (NoSuchBucket) when calling the PutObject operation: The specified bucket does not exist
[2025-07-27T13:47:03.462+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T13:47:03.463+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 66, in preprocess_and_upload
    processor = CryptoDataProcessor()
                ^^^^^^^^^^^^^^^^^^^^^
TypeError: CryptoDataProcessor.__init__() missing 1 required positional argument: 'config'
[2025-07-27T13:47:03.480+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T120000, start_date=20250727T134646, end_date=20250727T134703
[2025-07-27T13:47:03.526+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 2 for task preprocess_and_upload (CryptoDataProcessor.__init__() missing 1 required positional argument: 'config'; 375)
[2025-07-27T13:47:03.556+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T13:47:03.572+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T13:47:03.607+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-07-27T13:58:39.208+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-27T13:58:39.245+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:58:39.255+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [queued]>
[2025-07-27T13:58:39.256+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-07-27T13:58:39.502+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): preprocess_and_upload> on 2025-07-27 12:00:00+00:00
[2025-07-27T13:58:39.518+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'preprocessing_hourly', 'preprocess_and_upload', 'scheduled__2025-07-27T12:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_inference.py', '--cfg-path', '/tmp/tmpjq3effrz']
[2025-07-27T13:58:39.520+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=672) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-07-27T13:58:39.521+0000] {standard_task_runner.py:91} INFO - Job 7: Subtask preprocess_and_upload
[2025-07-27T13:58:39.522+0000] {standard_task_runner.py:63} INFO - Started process 691 to run task
[2025-07-27T13:58:39.538+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-27T13:58:39.580+0000] {task_command.py:426} INFO - Running <TaskInstance: preprocessing_hourly.preprocess_and_upload scheduled__2025-07-27T12:00:00+00:00 [running]> on host f0724eaea138
[2025-07-27T13:58:39.710+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops' AIRFLOW_CTX_DAG_ID='preprocessing_hourly' AIRFLOW_CTX_TASK_ID='preprocess_and_upload' AIRFLOW_CTX_EXECUTION_DATE='2025-07-27T12:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-27T12:00:00+00:00'
[2025-07-27T13:58:39.714+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-27T13:58:39.776+0000] {ingestion_inference.py:55} INFO - Bucket crypto-preprocessed created
[2025-07-27T13:58:40.343+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-27 13:58:39.786843 to 2025-06-28 14:58:39.786843
[2025-07-27T13:58:40.603+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-28 14:58:39.786843 to 2025-06-29 15:58:39.786843
[2025-07-27T13:58:40.826+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-29 15:58:39.786843 to 2025-06-30 16:58:39.786843
[2025-07-27T13:58:41.061+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-06-30 16:58:39.786843 to 2025-07-01 17:58:39.786843
[2025-07-27T13:58:39.848+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-01 17:58:39.786843 to 2025-07-02 18:58:39.786843
[2025-07-27T13:58:40.638+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-02 18:58:39.786843 to 2025-07-03 19:58:39.786843
[2025-07-27T13:58:40.811+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-03 19:58:39.786843 to 2025-07-04 20:58:39.786843
[2025-07-27T13:58:41.263+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-04 20:58:39.786843 to 2025-07-05 21:58:39.786843
[2025-07-27T13:58:41.443+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-05 21:58:39.786843 to 2025-07-06 22:58:39.786843
[2025-07-27T13:58:41.646+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-06 22:58:39.786843 to 2025-07-07 23:58:39.786843
[2025-07-27T13:58:41.938+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-07 23:58:39.786843 to 2025-07-09 00:58:39.786843
[2025-07-27T13:58:42.173+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-09 00:58:39.786843 to 2025-07-10 01:58:39.786843
[2025-07-27T13:58:42.429+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-10 01:58:39.786843 to 2025-07-11 02:58:39.786843
[2025-07-27T13:58:42.898+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-11 02:58:39.786843 to 2025-07-12 03:58:39.786843
[2025-07-27T13:58:43.366+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-12 03:58:39.786843 to 2025-07-13 04:58:39.786843
[2025-07-27T13:58:43.575+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-13 04:58:39.786843 to 2025-07-14 05:58:39.786843
[2025-07-27T13:58:44.143+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-14 05:58:39.786843 to 2025-07-15 06:58:39.786843
[2025-07-27T13:58:44.356+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-15 06:58:39.786843 to 2025-07-16 07:58:39.786843
[2025-07-27T13:58:44.562+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-16 07:58:39.786843 to 2025-07-17 08:58:39.786843
[2025-07-27T13:58:44.737+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-17 08:58:39.786843 to 2025-07-18 09:58:39.786843
[2025-07-27T13:58:45.227+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-18 09:58:39.786843 to 2025-07-19 10:58:39.786843
[2025-07-27T13:58:45.549+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-19 10:58:39.786843 to 2025-07-20 11:58:39.786843
[2025-07-27T13:58:46.165+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-20 11:58:39.786843 to 2025-07-21 12:58:39.786843
[2025-07-27T13:58:46.589+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-21 12:58:39.786843 to 2025-07-22 13:58:39.786843
[2025-07-27T13:58:46.838+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-22 13:58:39.786843 to 2025-07-23 14:58:39.786843
[2025-07-27T13:58:47.310+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-23 14:58:39.786843 to 2025-07-24 15:58:39.786843
[2025-07-27T13:58:47.551+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-24 15:58:39.786843 to 2025-07-25 16:58:39.786843
[2025-07-27T13:58:48.028+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for BTC-USD from 2025-07-25 16:58:39.786843 to 2025-07-26 17:58:39.786843
[2025-07-27T13:58:48.233+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for BTC-USD from 2025-07-26 17:58:39.786843 to 2025-07-27 13:58:39.786843
[2025-07-27T13:58:48.395+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_BTC_USD_20250727135848.csv
[2025-07-27T13:58:48.621+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-27 13:58:39.786843 to 2025-06-28 14:58:39.786843
[2025-07-27T13:58:48.854+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-28 14:58:39.786843 to 2025-06-29 15:58:39.786843
[2025-07-27T13:58:49.044+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-29 15:58:39.786843 to 2025-06-30 16:58:39.786843
[2025-07-27T13:58:49.233+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-06-30 16:58:39.786843 to 2025-07-01 17:58:39.786843
[2025-07-27T13:58:49.431+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-01 17:58:39.786843 to 2025-07-02 18:58:39.786843
[2025-07-27T13:58:49.673+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-02 18:58:39.786843 to 2025-07-03 19:58:39.786843
[2025-07-27T13:58:49.881+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-03 19:58:39.786843 to 2025-07-04 20:58:39.786843
[2025-07-27T13:58:50.405+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-04 20:58:39.786843 to 2025-07-05 21:58:39.786843
[2025-07-27T13:58:50.896+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-05 21:58:39.786843 to 2025-07-06 22:58:39.786843
[2025-07-27T13:58:51.809+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-06 22:58:39.786843 to 2025-07-07 23:58:39.786843
[2025-07-27T13:58:52.023+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-07 23:58:39.786843 to 2025-07-09 00:58:39.786843
[2025-07-27T13:58:52.208+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-09 00:58:39.786843 to 2025-07-10 01:58:39.786843
[2025-07-27T13:58:52.432+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-10 01:58:39.786843 to 2025-07-11 02:58:39.786843
[2025-07-27T13:58:52.606+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-11 02:58:39.786843 to 2025-07-12 03:58:39.786843
[2025-07-27T13:58:53.090+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-12 03:58:39.786843 to 2025-07-13 04:58:39.786843
[2025-07-27T13:58:53.688+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-13 04:58:39.786843 to 2025-07-14 05:58:39.786843
[2025-07-27T13:58:54.227+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-14 05:58:39.786843 to 2025-07-15 06:58:39.786843
[2025-07-27T13:58:54.437+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-15 06:58:39.786843 to 2025-07-16 07:58:39.786843
[2025-07-27T13:58:54.980+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-16 07:58:39.786843 to 2025-07-17 08:58:39.786843
[2025-07-27T13:58:55.195+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-17 08:58:39.786843 to 2025-07-18 09:58:39.786843
[2025-07-27T13:58:55.409+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-18 09:58:39.786843 to 2025-07-19 10:58:39.786843
[2025-07-27T13:58:55.844+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-19 10:58:39.786843 to 2025-07-20 11:58:39.786843
[2025-07-27T13:58:56.352+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-20 11:58:39.786843 to 2025-07-21 12:58:39.786843
[2025-07-27T13:58:56.554+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-21 12:58:39.786843 to 2025-07-22 13:58:39.786843
[2025-07-27T13:58:56.895+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-22 13:58:39.786843 to 2025-07-23 14:58:39.786843
[2025-07-27T13:58:57.458+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-23 14:58:39.786843 to 2025-07-24 15:58:39.786843
[2025-07-27T13:58:57.643+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-24 15:58:39.786843 to 2025-07-25 16:58:39.786843
[2025-07-27T13:58:57.847+0000] {data_ingestion.py:62} INFO - Fetched 300 candles for ETH-USD from 2025-07-25 16:58:39.786843 to 2025-07-26 17:58:39.786843
[2025-07-27T13:58:58.073+0000] {data_ingestion.py:62} INFO - Fetched 240 candles for ETH-USD from 2025-07-26 17:58:39.786843 to 2025-07-27 13:58:39.786843
[2025-07-27T13:58:58.225+0000] {data_ingestion.py:103} INFO - Saved data to S3: s3://crypto-mlops-bucket/data/historical_ETH_USD_20250727135858.csv
[2025-07-27T13:58:58.238+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-27T13:58:58.239+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/ingestion_inference.py", line 67, in preprocess_and_upload
    df_features = processor.engineer_features(df_raw)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/src/data_processing.py", line 89, in engineer_features
    df = df.copy()
         ^^^^^^^
AttributeError: 'NoneType' object has no attribute 'copy'
[2025-07-27T13:58:58.267+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=preprocessing_hourly, task_id=preprocess_and_upload, execution_date=20250727T120000, start_date=20250727T135839, end_date=20250727T135858
[2025-07-27T13:58:58.288+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 7 for task preprocess_and_upload ('NoneType' object has no attribute 'copy'; 691)
[2025-07-27T13:58:58.318+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-07-27T13:58:58.341+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-27T13:58:58.345+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
